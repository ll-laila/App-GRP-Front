# @bshg/validation

`@bshg/validation` is a TypeScript library designed to simplify form input validation in Angular applications. It provides a convenient way to define and manage validation rules for form fields, making it easier to ensure data integrity and user input correctness.

## Installation

To install `@bshg/validation`, use npm or yarn:

```bash
npm install @bshg/validation
```

or

```bash
yarn add @bshg/validation
```

## Library Classes

### ValidatorItem API

#### Overview
- Purpose: ValidatorItem aims to streamline the validation process for individual fields by encapsulating their validation logic and error handling.
- Functionality: It enables developers to define validation rules for a field and determine its validity based on the provided criteria.

The `ValidatorItem` class offers a set of functions to facilitate the validation process for individual fields within a data object.

#### Constructor

- **Parameters**:
  - `field: () => T | undefined`: A function that returns the current value of the field to be validated.
  - `setter: (value: T | undefined) => void`: A function that sets the value of the field after validation.
  - `validation: ((value: T | undefined) => void) | undefined`: (Optional) A function that defines custom validation rules for the field.

#### validate(): void
Validates the current value of the field against the defined validation rules. Call this function to initiate the validation process for the field. 

#### reset(): void
Resets the validation state of the field, clearing any previous validation results and restoring the field to its initial state. Call this function to reset the field's validation status.

#### error(msg: string): void
Marks the field as invalid and sets an error message to be displayed. Provide the error message as a parameter when calling this function. Use it to indicate that the field failed validation and provide a descriptive error message.

#### Properties

- **valid: boolean | undefined**: Indicates whether the current value of the field is valid after validation.
- **message: string | undefined**: Contains the error message associated with the field if it failed validation.
- **field: () => T | undefined**: A getter function to retrieve the current value of the field.
- **setter: (value: T | undefined) => void**: A setter function to assign a new value to the field after validation.

### Validator API

#### Overview
- Purpose: Validator defines the structure and functionality for validating data objects in a consistent manner.
- Functionality: It provides abstract methods and properties to be implemented by concrete validator classes, enabling developers to customize validation logic for specific data objects.

The `Validator` class serves as a blueprint for implementing concrete validators to validate data objects.

#### Abstract Methods and Properties

- `validatorItems: ValidatorItem<any>[]`: An array of validator items representing the validation logic for individual fields within the data object.
- `getValidatorItem(fieldName: string): ValidatorItem<any>`: Abstract method to retrieve the validator item corresponding to the specified field name within the data object.
- `validate(): boolean`: Abstract method to initiate the validation process for the data object and return whether all validation items pass validation.
- `reset(): void`: Abstract method to reset the validation state of all validation items within the data object.
- `applyAll(): void`: Abstract method to trigger the validation process for all validation items within the data object.
- `nested(name: string, validator: Validator<any>): void`: Abstract method to define a nested validator for validating nested data structures within the data object.
- `import(results: ValidatorResult<any>[]): void`: Abstract method to import validation results from external sources and apply them to the validation items within the data object.

### ValidatorResult API

The `ValidatorResult` class represents the result of a validation operation for a specific field within a data object.
It is used to pass the validation status from other apps (like backend) to the validator to show the result validation of the server for example.

#### Overview
- **Purpose**: ValidatorResult provides structured feedback on the validation status of individual fields, including the field name, value, validation status, and error message.
- **Functionality**: It encapsulates the outcome of a validation process, enabling developers to identify fields that failed validation and retrieve associated error messages.

#### Properties

- `field: string`: Specifies the name of the field that was validated.
- `value: T`: Represents the value of the field at the time of validation.
- `valid: boolean`: Indicates whether the field passed validation (`true`) or failed validation (`false`).
- `message: string`: Contains an error message if the field failed validation, providing insights into the reason for validation failure.

#### Example Usage

```typescript
const result = new ValidatorResult<number>();
result.field = "age";
result.value = 25;
result.valid = true;
result.message = ""; // No error message as the field passed validation
```

In this example, a `ValidatorResult` instance is created to represent the validation result for a field named "age" with a value of 25. The field is deemed valid (`valid: true`), and no error message is provided (`message: ""`).<br>

Ensure that the `field` property accurately reflects the name of the validated field within the data object.

## Usage

### Defining Your Data Class

First, define your data class, for example, `User`:

```typescript
export class User {
  username: string | undefined;
  password: string | undefined;
  confirmPassword: string | undefined;
  email: string | undefined;
  phone: string | undefined;
}
```

### Defining Validation Rules

Define validation rules for each field of the `User` object using the `ValidatorItem` class provided by `@bshg/validation`. For instance, defining validation rules for the `username` field:

```typescript
import { Validator, ValidatorItem } from "@bshg/validation";

export class UserValidator extends Validator<User> {
  username = new ValidatorItem<string>(
    () => this.item().username, // method to get the field value
    (value) => this.item().username = value, // mthod to assign value to the field
    (value) => { // method containing all field vaidation rules
      this.username.stringValidators
        ?.required()
        ?.valid();
    }
  );

  // Other fields validation items...
}
```

### Using the Validator

Once imported, use the `UserValidator` class to validate `User` objects in your Angular components or services. Example usage:

```typescript
import { Component } from '@angular/core';
import { UserValidator } from './user-validator'; // Import your validator class
import { User } from './user'; // Import your User class

@Component({
  selector: 'app-register',
  templateUrl: './register.component.html',
  styleUrls: ['./register.component.scss']
})
export class RegisterComponent {
  user: User = new User();
  validator = AppUserValidator.init(() => this.item)

  createUser() {
    if (!this.validator.validate()) return;
    // Handle form submission...
  }
}
```

```html
<input [(ngModel)]="user.username" (blur)="validator.username.validate()">
@if( validator.username.valid == false ) {
    <small>{{ validator.username.message }}</small>
}
```

Replace `register.component.html` content with your actual HTML template.
