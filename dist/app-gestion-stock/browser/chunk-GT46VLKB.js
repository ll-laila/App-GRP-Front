import{a as ye,b as Le}from"./chunk-EXOHPXTY.js";import{a as Ee,b as be}from"./chunk-OKSUT35I.js";import{a as Ce,b as Se}from"./chunk-LDMW65QK.js";import{a as ge}from"./chunk-J5REKJTI.js";import{a as xe,b as ve}from"./chunk-GTWPVTZV.js";import{a as _e,b as he}from"./chunk-ZV6L5X3B.js";import{b as oe,c as ae,f as se,i as le,j as me,k as ce,n as de}from"./chunk-RMR25O2K.js";import{a as pe,b as ue}from"./chunk-5ID3IPCN.js";import{$ as ie,I as K,J as X,K as Y,L as Z,P as $,T as ee,U as R,_ as te,p as B,ta as ne,ua as re,v as j,w as Q,y as J}from"./chunk-ETPUSV7N.js";import{c as D}from"./chunk-DKLNZNMU.js";import{a as fe}from"./chunk-PTMIGOEM.js";import{d as q,e as H}from"./chunk-EVAI7AMW.js";import{Cb as f,Ib as I,Jb as G,Kb as N,Lb as F,Mb as V,Nb as n,Nd as A,Ob as r,Pb as x,Sb as y,Tb as U,Wb as g,Wd as k,Yb as c,ec as L,fc as a,ga as v,gb as s,gc as d,hc as P,ka as z,lc as S,mc as E,nc as b,pc as W,va as p,vc as M,wa as u,wb as h,xa as _,xb as T,ya as C,yb as w}from"./chunk-BXK32XEB.js";var O=function(o){return o.LIVRE="LIVRE",o}(O||{});var we=()=>[R,k,B,H,ie,te,ne,D],Ie=()=>[k];function Fe(o,m){o&1&&x(0,"c-spinner",8)}function Ve(o,m){o&1&&(_(),x(0,"svg",9))}function Ue(o,m){o&1&&x(0,"c-spinner",8)}function Me(o,m){o&1&&(_(),x(0,"svg",11))}function ke(o,m){o&1&&y(0)}function De(o,m){o&1&&y(0)}function Be(o,m){if(o&1){let i=U();n(0,"c-row",2)(1,"c-nav",3)(2,"c-nav-item",4)(3,"button",5),g("click",function(){p(i);let t=c();return u(t.cancel())}),a(4,"Annuler"),r()(),n(5,"c-nav-item",6)(6,"button",7),g("click",function(){p(i);let t=c();return u(t.reset())}),h(7,Fe,1,0,"c-spinner",8)(8,Ve,1,0,":svg:svg",9),a(9," Reset "),r()(),n(10,"c-nav-item",6)(11,"button",10),g("click",function(){p(i);let t=c();return u(t.update())}),h(12,Ue,1,0,"c-spinner",8)(13,Me,1,0,":svg:svg",11),a(14," Modifier "),r()()()(),h(15,ke,1,0,"ng-container",12)(16,De,1,0,"ng-container",12)}if(o&2){let i=c(),e=L(7),t=L(9);s(7),I(i.resetting?7:8),s(5),I(i.sending?12:13),s(3),f("ngTemplateOutlet",e),s(),f("ngTemplateOutlet",t)}}function Re(o,m){o&1&&y(0)}function Oe(o,m){if(o&1&&h(0,Re,1,0,"ng-container",12),o&2){c();let i=L(7);f("ngTemplateOutlet",i)}}function ze(o,m){if(o&1&&(n(0,"option",26),a(1),r()),o&2){let i=m.$implicit;f("value",i.id),s(),d(i.nom)}}function Ge(o,m){if(o&1&&(n(0,"option",26),a(1),r()),o&2){let i=m.$implicit;f("value",i.id),s(),d(i.code)}}function Ne(o,m){if(o&1){let i=U();n(0,"c-card",2)(1,"c-card-header")(2,"strong",13),a(3,'Merci de renseigner les d\xE9tails n\xE9cessaires pour mettre \xE0 jour les informations de ce "Bon de livraison"'),r()(),n(4,"c-card-body")(5,"c-row",14)(6,"c-col",15),_(),x(7,"svg",16),C(),n(8,"label",17),a(9,"Code"),r(),n(10,"input",18),b("ngModelChange",function(t){p(i);let l=c();return E(l.item.code,t)||(l.item.code=t),u(t)}),r()(),n(11,"c-col",15)(12,"label",19),a(13,"Date de Cr\xE9ation"),r(),n(14,"input",20),b("ngModelChange",function(t){p(i);let l=c();return E(l.item.dateCreation,t)||(l.item.dateCreation=t),u(t)}),r()(),n(15,"c-col",15)(16,"label",21),a(17,"Date d'Expedition"),r(),n(18,"input",22),b("ngModelChange",function(t){p(i);let l=c();return E(l.item.dateExpedition,t)||(l.item.dateExpedition=t),u(t)}),r()(),n(19,"c-col",15),_(),x(20,"svg",23),C(),n(21,"label",24),a(22,"Fournisseur"),r(),n(23,"c-input-group")(24,"select",25),b("ngModelChange",function(t){p(i);let l=c();return E(l.fournisseur.id,t)||(l.fournisseur.id=t),u(t)}),g("change",function(){p(i);let t=c();return u(t.selectFournisseur())}),F(25,ze,2,2,"option",26,N),r(),n(27,"button",27),g("click",function(){p(i);let t=c();return u(t.navigateToFournisseurCreate())}),_(),x(28,"svg",28),r()()(),C(),n(29,"c-col",15),_(),x(30,"svg",29),C(),n(31,"label",30),a(32,"Entreprise"),r(),n(33,"input",31),g("blur",function(){p(i);let t=c();return u(t.validator.code.validate())}),r(),n(34,"c-form-feedback",32),a(35),r()(),n(36,"c-col",15),_(),x(37,"svg",29),C(),n(38,"label",33),a(39,"Code Bon de Commande"),r(),n(40,"c-input-group")(41,"select",34),g("change",function(t){p(i);let l=c();return u(l.selectBonComd(t))}),h(42,Ge,2,2,"option",35),r()()()()()()}if(o&2){let i=c();s(10),S("ngModel",i.item.code),s(4),S("ngModel",i.item.dateCreation),s(4),S("ngModel",i.item.dateExpedition),s(6),S("ngModel",i.fournisseur.id),s(),V(i.fournisseurList),s(8),f("value",i.item.entreprise==null?null:i.item.entreprise.nom)("valid",i.validator.code.valid),s(),f("valid",!1),s(),d(i.validator.code.message),s(7),f("ngForOf",i.bonCommandeList)("ngForTrackBy",i.trackById)}}function Pe(o,m){if(o&1&&(n(0,"tr")(1,"td"),a(2),r(),n(3,"td"),a(4),r(),n(5,"td"),a(6),r(),n(7,"td"),a(8),r(),n(9,"td"),a(10),r(),n(11,"td",41)(12,"button",42),_(),x(13,"svg",43),r()()()),o&2){let i=m.$implicit;s(2),P(" ",i.produit!=null?i.produit.nom:"null"," "),s(2),d(i.prix),s(2),d(i.total),s(2),d(i.quantite),s(2),d(i.disque)}}function We(o,m){if(o&1&&(n(0,"c-card",2)(1,"c-card-header")(2,"strong",36),a(3,"S\xE9lectionner des produits"),r()(),n(4,"c-card-body")(5,"table",37)(6,"thead",38)(7,"tr")(8,"th",39),a(9,"Produit"),r(),n(10,"th",39),a(11,"Prix"),r(),n(12,"th",39),a(13,"Total"),r(),n(14,"th",39),a(15,"Quantite"),r(),n(16,"th",39),a(17,"Remise"),r(),n(18,"th",40),a(19,"Actions"),r()()(),n(20,"tbody"),F(21,Pe,14,5,"tr",null,G),r()()()(),n(23,"c-card",2)(24,"c-card-header")(25,"strong",36),a(26,"Informations supplimentaire"),r()(),n(27,"c-card-body")(28,"table",37)(29,"thead",38)(30,"tr")(31,"th",39),a(32,"Unit\xE9s total"),r(),n(33,"th",39),a(34,"Remise Global"),r(),n(35,"th",39),a(36,"Taxe"),r(),n(37,"th",39),a(38,"Sous total"),r(),n(39,"th",39),a(40,"Total"),r()()(),n(41,"tbody")(42,"tr")(43,"td"),a(44),r(),n(45,"td"),a(46),r(),n(47,"td"),a(48),r(),n(49,"td"),a(50),r(),n(51,"td"),a(52),r()()()()()()),o&2){let i=c();s(5),f("hover",!0)("responsive",!0)("striped",!0),s(16),V(i.item.livraisonProduit),s(7),f("hover",!0)("responsive",!0)("striped",!0),s(16),d(i.item.totalUnites),s(2),d(i.item.remiseGlobal),s(2),d(i.item.taxeExpedition==null?null:i.item.taxeExpedition.nom),s(2),d(i.item.sousTotal),s(2),d(i.item.total)}}var gt=(()=>{let m=class m{constructor(){this.isPartOfUpdateForm=!1,this.sending=!1,this.resetting=!1,this.standAlon=!0,this.router=v(q),this.service=v(be),this.bonCommandeService=v(ve),this.taxeService=v(Se),this.toasterService=v(ge),this.fournisseurService=v(he),this.entrepriseService=v(ue),this.entrepriseSelectedService=v(fe),this.validator=ye.init(()=>this.item),this.bonCommandeList=[],this.bonCommandeSelected=new xe,this.statutLivraisonEnumList=Object.values(O)}set setItemGetter(e){this.itemGetter=e,this.standAlon=!1}set setItemSetter(e){this.itemSetter=e}set setValidator(e){this.validator=e}ngAfterContentInit(){!this.isPartOfUpdateForm&&this.item.id==null&&this.router.navigate(["/inventaire/livraison/livraison"]).then()}ngOnInit(){if(this.loadEntreprise(),this.service.keepData){let e=this.taxeService.createdItemAfterReturn;e.created&&(this.item.taxeExpedition=e.item,this.validator.taxeExpedition.validate());let t=this.fournisseurService.createdItemAfterReturn;t.created&&(this.item.fournisseur=t.item,this.validator.fournisseur.validate())}else this.validator.reset();this.loadTaxeList(),this.loadFournisseurList(),this.boncmds(this.item.fournisseur.id)}loadEntreprise(){this.entrepriseService.findById(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>{this.item.entreprise=e,console.log("entre :",this.item.entreprise)},error:e=>console.log(e)})}loadTaxeList(){this.taxeService.findAllOptimized().subscribe({next:e=>this.taxeList=e,error:e=>console.log(e)})}loadFournisseurList(){this.fournisseurService.getFournisseurs(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>{this.fournisseurList=e},error:e=>console.log(e)})}loadEntrepriseList(){this.entrepriseService.findAllOptimized().subscribe({next:e=>this.entrepriseList=e,error:e=>console.log(e)})}update(){console.log(this.item),this.service.update().subscribe({next:e=>{this.router.navigate(["/inventaire/livraison/livraison"]).then(),this.toasterService.toast({message:"le livraison a \xE9t\xE9 modifi\xE9",color:"success"})},error:e=>{this.sending=!1,console.log(e)}})}selectBonComd(e){let t=e.target.value,l=this.bonCommandeList.find(Te=>Te.id===parseInt(t,10));l&&(this.bonCommandeSelected=l,this.mapBonCommandeToLivraison(l))}mapBonCommandeToLivraison(e){this.item.bonCommande=e,this.item.fournisseur=e.fournisseur,this.item.dateCreation=e.dateCreation,this.item.dateExpedition=e.dateExpedition,this.item.entreprise=e.entreprise,this.item.totalUnites=e.totalUnites,this.item.remiseGlobal=e.remiseGlobal,this.item.sousTotal=e.sousTotal,this.item.total=e.total,this.item.taxeExpedition=e.taxeExpedition,this.item.livraisonProduit=e.bonCommandeProduit?.map(t=>{let l=new Le;return l.id=t.id,l.total=t.total,l.quantite=t.quantite,l.disque=t.disque,l.produit=t.produit,l.prix=t.prix,l})||[]}trackById(e,t){return t.id}selectFournisseur(){this.boncmds(this.fournisseur.id)}boncmds(e){this.bonCommandeService.findByIdFor(e).subscribe({next:t=>{this.bonCommandeList=t},error:t=>{console.log(t)}})}findBncmd(){this.bonCommandeService.findById(this.item.bonCommande?.id).subscribe({next:e=>{this.item.bonCommande=e,this.item.fournisseur=e.fournisseur,this.item.dateCreation=e.dateCreation,this.item.dateExpedition=e.dateExpedition,this.item.entreprise=e.entreprise},error:e=>console.log(e)})}reset(){this.resetting=!0,this.service.findById(this.item.id).subscribe({next:e=>{this.item=e,this.validator.reset(),this.resetting=!1},error:e=>{console.log(e),this.resetting=!1}})}get items(){return this.service.items}set items(e){this.service.items=e}get item(){return this.itemGetter()}set item(e){this.itemSetter(e)}itemGetter(){return this.service.item}itemSetter(e){this.service.item=e}get taxeExpedition(){return this.item.taxeExpedition==null&&(this.item.taxeExpedition=new Ce),this.item.taxeExpedition}set taxeExpedition(e){this.item.taxeExpedition=e}get fournisseur(){return this.item.fournisseur==null&&(this.item.fournisseur=new _e),this.item.fournisseur}set fournisseur(e){this.item.fournisseur=e}get entreprise(){return this.item.entreprise==null&&(this.item.entreprise=new pe),this.item.entreprise}set entreprise(e){this.item.entreprise=e}navigateToTaxeCreate(){this.taxeService.returnUrl=this.router.url,this.router.navigate(["/parametres/taxe/create"]).then()}navigateToFournisseurCreate(){this.fournisseurService.returnUrl=this.router.url,this.router.navigate(["/contacts/fournisseur/create"]).then()}navigateToEntrepriseCreate(){this.entrepriseService.returnUrl=this.router.url,this.router.navigate(["/parametres/entreprise/create"]).then()}cancel(){this.item=new Ee}};m.\u0275fac=function(t){return new(t||m)},m.\u0275cmp=z({type:m,selectors:[["app-livraison-update"]],inputs:{setItemGetter:[0,"getter","setItemGetter"],setItemSetter:[0,"setter","setItemSetter"],setValidator:[0,"validator","setValidator"]},standalone:!0,features:[W],decls:10,vars:2,consts:[["createFrom",""],["livraisonProduitCreate",""],[1,"mb-3"],[1,"hstack","gap"],[1,"p-2","ms-auto"],["cButton","","color","secondary","variant","outline","routerLink","/inventaire/livraison/livraison",3,"click"],[1,"p-2"],["cButton","","color","dark",3,"click"],["aria-hidden","true","size","sm"],["cIcon","","name","cilReload"],["cButton","","color","primary",3,"click"],["cIcon","","name","cilPen"],[4,"ngTemplateOutlet"],[1,"responsive-header",2,"color","#1d0528","font-family","'Times New Roman'","font-size","21px","margin-left","300px"],[1,"g-3"],["sm","4"],["cIcon","","name","cil-barcode",2,"color","blue","font-size","30px"],["cLabel","","for","code",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","code","type","text","placeholder","Code","disabled","true","name","code",3,"ngModelChange","ngModel"],["cLabel","","for","dateCreation",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","dateCreation","type","date","placeholder","DateCreation","name","dateCreation",3,"ngModelChange","ngModel"],["cLabel","","for","dateExpedition",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","dateExpedition","type","date","placeholder","DateExpedition","name","dateExpedition",3,"ngModelChange","ngModel"],["cIcon","","name","cilUser",2,"color","blue","font-size","30px"],["cLabel","","for","fournisseur",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cSelect","","id","fournisseur","name","fournisseur",3,"ngModelChange","change","ngModel"],[3,"value"],["cButton","","color","secondary","type","button","variant","outline",3,"click"],["cIcon","","name","cilPlus"],["cIcon","","name","cil-building",2,"color","blue","font-size","30px"],["cLabel","","for","entreprise",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","entreprise","type","text","name","entreprise","disabled","true",3,"blur","value","valid"],[3,"valid"],["cLabel","","for","bndCommande",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cSelect","","id","bndCommande","name","bndCommande",3,"change"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["align","middle","cTable","",1,"mb-0","border",3,"hover","responsive","striped"],[1,"text-nowrap","text-truncate"],[1,"bg-body-tertiary"],[1,"bg-body-tertiary",2,"display","flex","justify-content","end"],[2,"display","flex","justify-content","end"],["cButton","","color",""],["cIcon","","name","cil-trash","size","lg"]],template:function(t,l){t&1&&(h(0,Be,17,4),T(1,0,we),h(3,Oe,1,1),T(4,3,Ie),h(6,Ne,43,10,"ng-template",null,0,M)(8,We,53,11,"ng-template",null,1,M)),t&2&&(s(),w(l.standAlon),s(3),w(!l.standAlon))},dependencies:[Y,R,ee,$,de,me,ce,oe,le,ae,se,Z,j,Q,J,X,B,K,D,A,re],styles:['@charset "UTF-8";.responsive-header[_ngcontent-%COMP%]{font-family:Times New Roman;font-size:21px;margin-left:300px}@media (max-width: 1024px){.responsive-header[_ngcontent-%COMP%]{font-size:18px;margin-left:100px}}@media (max-width: 768px){.responsive-header[_ngcontent-%COMP%]{font-size:16px;margin-left:50px;text-align:center}}@media (max-width: 480px){.responsive-header[_ngcontent-%COMP%]{font-size:14px;margin-left:20px;text-align:center}}']});let o=m;return o})();export{gt as a};
