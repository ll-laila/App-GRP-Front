import{a as Ge,b as Ae}from"./chunk-YVC2EI2H.js";import{a as j,b as ze}from"./chunk-LEDPVUJ2.js";import"./chunk-B5ILILCU.js";import"./chunk-4LXP3TMW.js";import{a as H}from"./chunk-UBDUPB6Y.js";import"./chunk-JPRJCQ7A.js";import{a as O}from"./chunk-IHMPC7RH.js";import"./chunk-ZDT4ONQF.js";import"./chunk-L4RF7HMY.js";import"./chunk-NRMQ4WUC.js";import"./chunk-CJTN6TSS.js";import{a as Ne,b as Be}from"./chunk-JJWAPVHG.js";import{a as Re,b as Fe}from"./chunk-URSAOOCG.js";import{a as U,b as We}from"./chunk-ECGNXNAA.js";import"./chunk-SR3OXJX3.js";import{a as Le}from"./chunk-J5REKJTI.js";import{a as q}from"./chunk-EAROEH6U.js";import{b as Ie}from"./chunk-A6E5FFHP.js";import{a as ke,b as Pe}from"./chunk-52VFGFI6.js";import{b as _e,c as he,f as xe,h as ge,i as fe,j as Ce,k as be,m as Se,n as ye}from"./chunk-RMR25O2K.js";import{a as Ee,b as Te}from"./chunk-36NSVSE4.js";import{$ as me,I as ne,J as re,K as ae,L as oe,P as le,T as se,U as A,_ as ce,p as G,ta as de,ua as pe,v as ee,w as te,y as ie}from"./chunk-ETPUSV7N.js";import{c as z}from"./chunk-DKLNZNMU.js";import{a as ue}from"./chunk-NFNWDAVZ.js";import{b as Me}from"./chunk-OKGYADQP.js";import{a as De}from"./chunk-PTMIGOEM.js";import{a as Ve}from"./chunk-PWEKJSU7.js";import"./chunk-KBKVWUMZ.js";import{d as Y,e as Z}from"./chunk-EVAI7AMW.js";import{a as we}from"./chunk-2BQUVQN4.js";import{a as ve}from"./chunk-RTZTBWEW.js";import"./chunk-VVDYSQS6.js";import{b as X}from"./chunk-LUIBGOM6.js";import{Cb as c,Ib as B,Kb as D,Lb as V,Mb as M,Nb as n,Ob as r,Pb as v,Sb as I,Tb as P,Wb as h,Yb as d,aa as $,ec as L,fc as s,ga as x,gb as o,gc as _,hc as J,ka as Q,lc as b,mc as S,nc as y,pc as K,va as p,vc as W,wa as u,wb as T,xa as g,xb as F,ya as C,yb as N}from"./chunk-BXK32XEB.js";import"./chunk-RGL3W33T.js";var k=class{};var qe=(()=>{let m=class m{constructor(){this.api=ve.apiUrl+"devisproduit",this.http=x(X),this.keepData=!1,this.toReturn=()=>this.returnUrl!=null}findAll(){return this.http.get(this.api)}findById(e){return this.http.get(`${this.api}/id/${e}`)}findAllOptimized(){return this.http.get(`${this.api}/optimized`)}findPaginated(e=0,t=10){return this.http.get(`${this.api}/paginated?page=${e}&size=${t}`)}create(){return this.http.post(this.api,this.item)}createList(){return this.http.post(`${this.api}/all`,this.items)}update(){return this.http.put(this.api,this.item)}updateList(){return this.http.put(`${this.api}/all`,this.items)}delete(e){return this.http.delete(this.api,{body:e})}deleteAll(e){return this.http.delete(this.api,{body:e})}deleteById(e){return this.http.delete(`${this.api}/id/${e}`)}deleteByProduitId(e){return this.http.delete(`${this.api}/produit/${e}`)}findByProduitId(e){return this.http.get(`${this.api}/produit/${e}`)}deleteByDevisId(e){return this.http.delete(`${this.api}/devis/${e}`)}findByDevisId(e){return this.http.get(`${this.api}/devis/${e}`)}get itemIsNull(){return this._item==null}get items(){return this._items==null&&(this._items=[]),this._items}get pagination(){return this._pagination==null&&(this._pagination=new we),this._pagination}set pagination(e){this._pagination=e}set items(e){this._items=e}get item(){return this._item==null&&(this._item=new k),this._item}set item(e){this._item=e}get createdItemAfterReturn(){let e={item:this.item,created:this.toReturn()};return this.returnUrl="",this.item=new k,e}getNextCode(){return this.http.get(`${this.api}/next-code`)}};m.\u0275fac=function(t){return new(t||m)},m.\u0275prov=$({token:m,factory:m.\u0275fac,providedIn:"root"});let l=m;return l})();var Oe=()=>[A,import("./chunk-K4L4KWTC.js").then(l=>l.NgTemplateOutlet),G,Z,me,ce,de,z],He=()=>[import("./chunk-K4L4KWTC.js").then(l=>l.NgTemplateOutlet)];function je(l,m){if(l&1){let i=P();n(0,"c-nav-item",4)(1,"button",12),h("click",function(){p(i);let t=d(2);return u(t.retour())}),s(2,"Retour"),r()()}if(l&2){let i=d(2);o(),c("routerLink",i.returnUrl)}}function $e(l,m){l&1&&v(0,"c-spinner",9)}function Qe(l,m){l&1&&(g(),v(0,"svg",10))}function Je(l,m){l&1&&I(0)}function Ke(l,m){l&1&&I(0)}function Xe(l,m){if(l&1){let i=P();n(0,"c-row",2)(1,"c-nav",3),T(2,je,3,1,"c-nav-item",4),n(3,"c-nav-item",5)(4,"button",6),h("click",function(){p(i);let t=d();return u(t.cancel())}),s(5," Annuler "),r()(),n(6,"c-nav-item",4)(7,"button",7),h("click",function(){p(i);let t=d();return u(t.reset())}),s(8,"R\xE9initialiser"),r()(),n(9,"c-nav-item",4)(10,"button",8),h("click",function(){p(i);let t=d();return u(t.create())}),T(11,$e,1,0,"c-spinner",9)(12,Qe,1,0,":svg:svg",10),s(13," Cr\xE9er "),r()()()(),T(14,Je,1,0,"ng-container",11)(15,Ke,1,0,"ng-container",11)}if(l&2){let i=d(),e=L(7),t=L(9);o(2),B(i.toReturn?2:-1),o(9),B(i.sending?11:12),o(3),c("ngTemplateOutlet",e),o(),c("ngTemplateOutlet",t)}}function Ye(l,m){l&1&&I(0)}function Ze(l,m){if(l&1&&T(0,Ye,1,0,"ng-container",11),l&2){d();let i=L(7);c("ngTemplateOutlet",i)}}function et(l,m){if(l&1&&(n(0,"option",33),s(1),r()),l&2){let i=m.$implicit;c("value",i),o(),_(i)}}function tt(l,m){if(l&1&&(n(0,"option",33),s(1),r()),l&2){let i=m.$implicit;c("value",i.id),o(),_(i.nom)}}function it(l,m){if(l&1&&(n(0,"option",33),s(1),r()),l&2){let i=m.$implicit;c("value",i.id),o(),_(i.nom)}}function nt(l,m){if(l&1&&(n(0,"option",33),s(1),r()),l&2){let i=m.$implicit;c("value",i.id),o(),_(i.nom)}}function rt(l,m){if(l&1&&(n(0,"option",33),s(1),r()),l&2){let i=m.$implicit;c("value",i.id),o(),_(i.nouvelleDevise==null?null:i.nouvelleDevise.labelle)}}function at(l,m){if(l&1){let i=P();n(0,"c-card",2)(1,"c-card-header")(2,"strong",13),s(3,'Veuillez remplir les informations ci-dessous pour cr\xE9er un nouveau "Devis"'),r()(),n(4,"c-card-body")(5,"c-row",14)(6,"c-col",15),g(),v(7,"svg",16),C(),n(8,"label",17),s(9,"Code"),r(),n(10,"input",18),y("ngModelChange",function(t){p(i);let a=d();return S(a.item.code,t)||(a.item.code=t),u(t)}),h("blur",function(){p(i);let t=d();return u(t.validator.code.validate())}),r(),n(11,"c-form-feedback",19),s(12),r()(),n(13,"c-col",15),g(),v(14,"svg",20),C(),n(15,"label",21),s(16,"Date d'Experation"),r(),n(17,"input",22),y("ngModelChange",function(t){p(i);let a=d();return S(a.item.dateExperation,t)||(a.item.dateExperation=t),u(t)}),h("blur",function(){p(i);let t=d();return u(t.validator.dateExperation.validate())}),r(),n(18,"c-form-feedback",19),s(19),r()(),n(20,"c-col",15),g(),v(21,"svg",20),C(),n(22,"label",23),s(23,"Date de Cr\xE9ation"),r(),n(24,"input",24),y("ngModelChange",function(t){p(i);let a=d();return S(a.item.dateCreation,t)||(a.item.dateCreation=t),u(t)}),h("blur",function(){p(i);let t=d();return u(t.validator.dateCreation.validate())}),r(),n(25,"c-form-feedback",19),s(26),r()(),n(27,"c-col",15),g(),v(28,"svg",20),C(),n(29,"label",25),s(30,"DateExpedition"),r(),n(31,"input",26),y("ngModelChange",function(t){p(i);let a=d();return S(a.item.dateExpedition,t)||(a.item.dateExpedition=t),u(t)}),h("blur",function(){p(i);let t=d();return u(t.validator.dateExpedition.validate())}),r(),n(32,"c-form-feedback",19),s(33),r()(),n(34,"c-col",15),g(),v(35,"svg",27),C(),n(36,"label",28),s(37,"Remise"),r(),n(38,"input",29),y("ngModelChange",function(t){p(i);let a=d();return S(a.item.rabais,t)||(a.item.rabais=t),u(t)}),h("blur",function(){p(i);let t=d();return u(t.validator.rabais.validate())}),r(),n(39,"c-form-feedback",19),s(40),r()(),n(41,"c-col",15),g(),v(42,"svg",30),C(),n(43,"label",31),s(44,"Type de Remise"),r(),n(45,"select",32),y("ngModelChange",function(t){p(i);let a=d();return S(a.item.typeRabais,t)||(a.item.typeRabais=t),u(t)}),h("blur",function(){p(i);let t=d();return u(t.validator.typeRabais.validate())}),V(46,et,2,2,"option",33,D),r(),n(48,"c-form-feedback",19),s(49),r()(),n(50,"c-col",15),g(),v(51,"svg",34),C(),n(52,"label",35),s(53,"Taxe"),r(),n(54,"c-input-group")(55,"select",36),y("ngModelChange",function(t){p(i);let a=d();return S(a.taxe.id,t)||(a.taxe.id=t),u(t)}),h("blur",function(){p(i);let t=d();return u(t.validator.taxe.validate())}),V(56,tt,2,2,"option",33,D),r(),n(58,"button",37),h("click",function(){p(i);let t=d();return u(t.navigateToTaxeCreate())}),g(),v(59,"svg",10),r(),C(),n(60,"c-form-feedback",19),s(61),r()()(),n(62,"c-col",15),g(),v(63,"svg",34),C(),n(64,"label",38),s(65,"Taxe d'\xE9xpedition"),r(),n(66,"c-input-group")(67,"select",39),y("ngModelChange",function(t){p(i);let a=d();return S(a.taxeExpedition.id,t)||(a.taxeExpedition.id=t),u(t)}),h("blur",function(){p(i);let t=d();return u(t.validator.taxeExpedition.validate())}),V(68,it,2,2,"option",33,D),r(),n(70,"button",37),h("click",function(){p(i);let t=d();return u(t.navigateToTaxeCreate())}),g(),v(71,"svg",10),r(),C(),n(72,"c-form-feedback",19),s(73),r()()(),n(74,"c-col",15),g(),v(75,"svg",40),C(),n(76,"label",41),s(77,"Client"),r(),n(78,"c-input-group")(79,"select",42),y("ngModelChange",function(t){p(i);let a=d();return S(a.client.id,t)||(a.client.id=t),u(t)}),h("blur",function(){p(i);let t=d();return u(t.validator.client.validate())}),V(80,nt,2,2,"option",33,D),r(),n(82,"button",37),h("click",function(){p(i);let t=d();return u(t.navigateToClientCreate())}),g(),v(83,"svg",10),r(),C(),n(84,"c-form-feedback",19),s(85),r()()(),n(86,"c-col",15),g(),v(87,"svg",43),C(),n(88,"label",44),s(89,"Devise"),r(),n(90,"c-input-group")(91,"select",45),y("ngModelChange",function(t){p(i);let a=d();return S(a.devises.id,t)||(a.devises.id=t),u(t)}),h("blur",function(){p(i);let t=d();return u(t.validator.devises.validate())}),V(92,rt,2,2,"option",33,D),r(),n(94,"button",37),h("click",function(){p(i);let t=d();return u(t.navigateToDevisesCreate())}),g(),v(95,"svg",10),r(),C(),n(96,"c-form-feedback",19),s(97),r()()(),n(98,"c-col",15),g(),v(99,"svg",46),C(),n(100,"label",47),s(101,"Entreprise"),r(),v(102,"input",48),r()()()()}if(l&2){let i=d();o(10),b("ngModel",i.item.code),c("valid",i.validator.code.valid),o(),c("valid",!1),o(),_(i.validator.code.message),o(5),b("ngModel",i.item.dateExperation),c("valid",i.validator.dateExperation.valid),o(),c("valid",!1),o(),_(i.validator.dateExperation.message),o(5),b("ngModel",i.item.dateCreation),c("valid",i.validator.dateCreation.valid),o(),c("valid",!1),o(),_(i.validator.dateCreation.message),o(5),b("ngModel",i.item.dateExpedition),c("valid",i.validator.dateExpedition.valid),o(),c("valid",!1),o(),_(i.validator.dateExpedition.message),o(5),b("ngModel",i.item.rabais),c("valid",i.validator.rabais.valid),o(),c("valid",!1),o(),_(i.validator.rabais.message),o(5),b("ngModel",i.item.typeRabais),c("valid",i.validator.typeRabais.valid),o(),M(i.typeRabaisEnumList),o(2),c("valid",!1),o(),_(i.validator.typeRabais.message),o(6),b("ngModel",i.taxe.id),c("valid",i.validator.taxe.valid),o(),M(i.taxeList),o(4),c("valid",!1),o(),_(i.validator.taxe.message),o(6),b("ngModel",i.taxeExpedition.id),c("valid",i.validator.taxeExpedition.valid),o(),M(i.taxeList),o(4),c("valid",!1),o(),_(i.validator.taxeExpedition.message),o(6),b("ngModel",i.client.id),c("valid",i.validator.client.valid),o(),M(i.clientList),o(4),c("valid",!1),o(),_(i.validator.client.message),o(6),b("ngModel",i.devises.id),c("valid",i.validator.devises.valid),o(),M(i.devisesList),o(4),c("valid",!1),o(),_(i.validator.devises.message),o(5),c("value",i.item.entreprise==null?null:i.item.entreprise.nom)}}function ot(l,m){if(l&1){let i=P();n(0,"tr")(1,"td"),s(2),r(),n(3,"td"),s(4),r(),n(5,"td"),s(6),r(),n(7,"td")(8,"input",64),y("ngModelChange",function(t){let a=p(i).$implicit;return S(a.quantite,t)||(a.quantite=t),u(t)}),r()(),n(9,"td"),s(10),r(),n(11,"input",64),y("ngModelChange",function(t){let a=p(i).$implicit;return S(a.quantite,t)||(a.quantite=t),u(t)}),h("ngModelChange",function(){let t=p(i).$implicit,a=d(2);return u(a.onInputChange(t))}),r(),n(12,"td")(13,"input",64),y("ngModelChange",function(t){let a=p(i).$implicit;return S(a.disque,t)||(a.disque=t),u(t)}),r()(),n(14,"td",65)(15,"button",66),h("click",function(){p(i);let t=d(2);return u(t.deleteDevisProduit(t.itemDP))}),g(),v(16,"svg",67),r()()()}if(l&2){let i=m.$implicit;o(2),J(" ",i.produit!=null?i.produit.nom:"null"," "),o(2),_(i.prix),o(2),_(i.total),o(2),b("ngModel",i.quantite),o(2),_(i.produit==null||i.produit.taxe==null?null:i.produit.taxe.nom),o(),b("ngModel",i.quantite),o(2),b("ngModel",i.disque)}}function lt(l,m){if(l&1&&(n(0,"option",55),s(1),r()),l&2){let i=m.$implicit;c("ngValue",i),o(),_(i.nom)}}function st(l,m){if(l&1){let i=P();n(0,"c-card",2)(1,"c-card-header")(2,"strong"),s(3,"S\xE9lectionner des produits"),r()(),n(4,"c-card-body")(5,"table",49)(6,"thead",50)(7,"tr")(8,"th",51),s(9,"Produit"),r(),n(10,"th",51),s(11,"Prix"),r(),n(12,"th",51),s(13,"Total"),r(),n(14,"th",51),s(15,"Quantite"),r(),n(16,"th",51),s(17,"Taxe"),r(),n(18,"th",51),s(19,"Disponible"),r(),n(20,"th",51),s(21,"Disque"),r(),n(22,"th",52),s(23,"Actions"),r()()(),n(24,"tbody"),V(25,ot,17,7,"tr",null,D),r()(),n(27,"c-col",53)(28,"c-input-group")(29,"select",54),h("ngModelChange",function(t){p(i);let a=d();return u(a.addDevieProuits(t))}),V(30,lt,2,2,"option",55,D),r()()()()(),n(32,"c-card")(33,"c-card-body")(34,"c-col",15)(35,"label",56),s(36,"Unit\xE9s total "),r(),v(37,"input",57),n(38,"c-form-feedback",19),s(39),r()(),n(40,"c-col",15)(41,"label",58),s(42,"Remise Global"),r(),v(43,"input",59),r(),n(44,"c-col",15)(45,"label",60),s(46,"Sous total"),r(),v(47,"input",61),n(48,"c-form-feedback",19),s(49),r()(),n(50,"c-col",15)(51,"label",62),s(52,"Total"),r(),v(53,"input",63),n(54,"c-form-feedback",19),s(55),r()()()()}if(l&2){let i=d();o(5),c("hover",!0)("responsive",!0)("striped",!0),o(20),M(i.devisProduit),o(5),M(i.produitList),o(7),c("value",i.calculerSommeQuantite(i.devisProduit)),o(),c("valid",!1),o(),_(i.validator.totalUnites.message),o(4),c("value",i.calculeRemiseGlobal(i.devisProduit)),o(4),c("value",i.calculerSommeSousTotal(i.devisProduit)),o(),c("valid",!1),o(),_(i.validator.sousTotal.message),o(4),c("value",i.calculerSommeTotale(i.devisProduit)),o(),c("valid",!1),o(),_(i.validator.total.message)}}var si=(()=>{let m=class m{constructor(){this.sending=!1,this.standAlon=!0,this.toasterService=x(Le),this.router=x(Y),this.service=x(ze),this.taxeService=x(We),this.clientService=x(Pe),this.devisesService=x(Fe),this.niveauPrixService=x(Be),this.entrepriseService=x(Te),this.devisProduitSevice=x(qe),this.produitService=x(Ie),this.formBuilder=x(Se),this.entrepriseSelectedService=x(De),this.TypeRabaisEnum=H,this.tokenService=x(ue),this.userInfosService=x(Ve),this.employeService=x(Me),this.validator=Ge.init(()=>this.item),this.currentCodeNumber=1,this.paiementGetter=()=>this.paiement,this.paiementSetter=e=>this.paiement=e,this.retourProduitGetter=()=>this.retourProduit,this.retourProduitSetter=e=>this.retourProduit=e,this.dispo=0,this.typeRabaisEnumList=Object.values(H),this.statutDevisEnumList=Object.values(Ae)}set setItemGetter(e){this.itemGetter=e,this.standAlon=!1}set setItemSetter(e){this.itemSetter=e}set setValidator(e){this.validator=e}ngOnInit(){if(this.loadEntreprise(),this.service.keepData){let t=this.taxeService.createdItemAfterReturn;t.created&&(this.item.taxe=t.item,this.validator.taxe.validate());let a=this.taxeService.createdItemAfterReturn;a.created&&(this.item.taxeExpedition=a.item,this.validator.taxeExpedition.validate());let f=this.clientService.createdItemAfterReturn;f.created&&(this.item.client=f.item,this.validator.client.validate());let E=this.devisesService.createdItemAfterReturn;E.created&&(this.item.devises=E.item,this.validator.devises.validate());let w=this.niveauPrixService.createdItemAfterReturn;w.created&&(this.item.niveauPrix=w.item)}else this.reset(!1);this.service.keepData=!1,this.item.paiement=new q,this.item.retourProduit=new O,this.loadTaxeList(),this.loadDevisesList(),this.loadNiveauPrixList(),this.loadEntrepriseList(),this.loadProduitList(),(this.tokenService.getRole()?.some(t=>t=="ADMIN")?1:0)==1?this.getClientsForAdmin():this.getClientsForEmploye(),this.clientForm=this.formBuilder.group({code:[{value:this.generateCode(),disabled:!0}]}),this.service.getNextCode().subscribe({next:t=>this.item.code=t.code,error:t=>console.log(t)})}generateCode(){return"I"+this.currentCodeNumber.toString().padStart(7,"0")}loadProduitList(){this.produitService.findByEntrepriseId(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>this.produitList=e,error:e=>console.log(e)})}loadEntreprise(){this.entrepriseService.findById(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>{this.item.entreprise=e,console.log("entre :",this.item.entreprise)},error:e=>console.log(e)})}loadTaxeList(){this.taxeService.findAllOptimized().subscribe({next:e=>this.taxeList=e,error:e=>console.log(e)})}getClientsForAdmin(){this.entrepriseSelectedService.getEntrepriseSelected()!=0?this.clientService.getClients(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>{this.clientList=e,console.log("Clients :",e)},error:e=>console.log(e)}):this.entrepriseService.findByAdmin(this.userInfosService.getUsername()).subscribe(e=>{this.entreprises=e,console.log("Entreprises: ",this.entreprises),this.entreprises&&this.entreprises.length>0?this.clientService.getClients(this.entreprises[0].id).subscribe({next:t=>{this.clientList=t,console.log("Clients :",t)},error:t=>console.log(t)}):console.log("Aucune entreprise trouv\xE9e.")},e=>{console.log(e)})}getClientsForEmploye(){this.entrepriseSelectedService.getEntrepriseSelected()!=0?this.clientService.getClients(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>{this.clientList=e,console.log("Clients :",e)},error:e=>console.log(e)}):this.employeService.findByUserName(this.userInfosService.getUsername()).subscribe(e=>{console.log("empId: ",e.id),this.entrepriseService.findEntreprisesAdroitAcces(e.id).subscribe(t=>{this.entreprises=t,console.log("Entreprises\xC0droit: ",this.entreprises),this.entreprises&&this.entreprises.length>0&&this.clientService.getClients(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:a=>{this.clientList=a,console.log("Clients :",a)},error:a=>console.log(a)})},t=>{console.log(t)})},e=>{console.log(e)})}loadDevisesList(){this.devisesService.findAllOptimized().subscribe({next:e=>this.devisesList=e,error:e=>console.log(e)})}loadNiveauPrixList(){this.niveauPrixService.findAllOptimized().subscribe({next:e=>this.niveauPrixList=e,error:e=>console.log(e)})}loadEntrepriseList(){this.entrepriseService.findAllOptimized().subscribe({next:e=>this.entrepriseList=e,error:e=>console.log(e)})}create(){if(console.log(this.item),!this.validator.validate()){console.log(this.validator);return}this.sending=!0,this.service.create().subscribe({next:e=>{if(this.sending=!1,e!=null){if(this.item=e,this.toReturn){this.router.navigate([this.returnUrl]).then();return}this.router.navigate(["/ventes/devis/devis"]).then(),this.toasterService.toast({message:"Un nouveau devis a \xE9t\xE9 ajout\xE9",color:"success"})}},error:e=>{this.sending=!1,console.log(e),this.validator.import(e.error)}})}reset(e=!0){(e||this.item==null)&&(this.item=new j),this.validator.reset()}get items(){return this.service.items}set items(e){this.service.items=e}get item(){return this.itemGetter()}set item(e){this.itemSetter(e)}itemGetter(){return this.service.item}itemSetter(e){this.service.item=e}get paiement(){return this.item.paiement==null&&(this.item.paiement=new q),this.item.paiement}set paiement(e){this.item.paiement=e}get retourProduit(){return this.item.retourProduit==null&&(this.item.retourProduit=new O),this.item.retourProduit}set retourProduit(e){this.item.retourProduit=e}get taxe(){return this.item.taxe==null&&(this.item.taxe=new U),this.item.taxe}set taxe(e){this.item.taxe=e}get taxeExpedition(){return this.item.taxeExpedition==null&&(this.item.taxeExpedition=new U),this.item.taxeExpedition}set taxeExpedition(e){this.item.taxeExpedition=e}get client(){return this.item.client==null&&(this.item.client=new ke),this.item.client}set client(e){this.item.client=e}get devises(){return this.item.devises==null&&(this.item.devises=new Re),this.item.devises}set devises(e){this.item.devises=e}get niveauPrix(){return this.item.niveauPrix==null&&(this.item.niveauPrix=new Ne),this.item.niveauPrix}set niveauPrix(e){this.item.niveauPrix=e}get entreprise(){return this.item.entreprise==null&&(this.item.entreprise=new Ee),this.item.entreprise}set entreprise(e){this.item.entreprise=e}get devisProduit(){return this.item.devisProduit==null&&(this.item.devisProduit=[]),this.item.devisProduit}deleteDevisProduit(e){this.item.devisProduit=this.item.devisProduit?.filter(t=>t!==e)}calculeRemiseGlobal(e){let t=e.reduce((a,f)=>a+(f.disque||0),0);return this.item.remiseGlobal=t+this.item.rabais,this.item.remiseGlobal}calculerSommeSousTotal(e){let t=e.reduce((a,f)=>f?.quantite&&f?.prix?a+f.quantite*f.prix:a,0);return this.item.sousTotal=t,t.toFixed(2)}calculerSommeTotale(e){let t=e.reduce((f,E)=>{let w=this.calculerTotal(E);return console.log(`Total pour ${E.produit?.nom}: ${w}`),f+w},0),a=parseFloat(t.toFixed(2));return console.log(`Somme totale format\xE9e: ${a}`),this.item.total=a,a}calculerSommeQuantite(e){let t=e.reduce((a,f)=>a+(f.quantite||0),0);return this.item.totalUnites=t,t}calculerTotal(e){console.log(this.item);let t=0;if(e.produit){let a=0;a=e.produit?.produitNiveauPrix?.filter(w=>w.niveauPrix?.nom==this?.item.client?.niveauPrix?.nom)[0]?.prix||e.produit.prixGros,console.log("prixProduit",a);let f=e.quantite*a,E=e.produit.taxe?e.produit.taxe?.tauxImposition:0;if(this.item.typeRabais!=null&&this.item.typeRabais==this.TypeRabaisEnum.POURCENTAGE){let w=f*(1+E/100),R=w*(e.disque/100);t=w-R}if(this.item?.typeRabais!=null&&this.item?.typeRabais==this.TypeRabaisEnum.MONTANT){let w=f*(1+E/100),R=e.disque;t=w-R}}return parseFloat(t.toFixed(2))}addDevieProuits(e){console.log(e),this.item.devisProduit==null&&(this.item.devisProduit=[]);let t=new k;t.produit=e,console.log("produit",e),t.disque=0,t.quantite=1,this.dispo=e.disponible,e.disponible=e?.niveauStockInitial-t?.quantite,console.log("disponible",e.disponible),t.disponible=e.disponible,console.log(t.disponible),t.prix=e?.produitNiveauPrix?.filter(a=>a.niveauPrix?.id==this?.client?.niveauPrix?.id)[0]?.prix||e.prixGros,console.log("niveau prix du client",this?.client?.niveauPrix?.id),console.log(t.prix),t.total=this.calculerTotal(t),console.log(t.total),this.item.devisProduit=[...this.item.devisProduit,t],console.log(this.item.devisProduit)}onInputChange(e){e.quantite>0&&e.disque>0&&(e.produit&&(e.produit.disponible=this.dispo-e.quantite),e.total=this.calculerTotal(e))}get returnUrl(){return this.service.returnUrl}get itemDP(){return this.devisProduitSevice.item}get toReturn(){return this.service.toReturn()}navigateToTaxeCreate(){this.taxeService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/parametres/taxe/create"]).then()}navigateToClientCreate(){this.clientService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/contacts/client/create"]).then()}navigateToDevisesCreate(){this.devisesService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/parametres/devises/create"]).then()}navigateToNiveauPrixCreate(){this.niveauPrixService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/parametres/niveau-prix/create"]).then()}navigateToEntrepriseCreate(){this.entrepriseService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/parametres/entreprise/create"]).then()}cancel(){this.item=new j}retour(){this.router.navigate(["/pays/pays/list"]).then()}printReport(){window.print()}};m.\u0275fac=function(t){return new(t||m)},m.\u0275cmp=Q({type:m,selectors:[["app-devis-create"]],inputs:{setItemGetter:[0,"getter","setItemGetter"],setItemSetter:[0,"setter","setItemSetter"],setValidator:[0,"validator","setValidator"]},standalone:!0,features:[K],decls:10,vars:2,consts:[["createFrom",""],["devisProduitCreate",""],[1,"mb-3"],[1,"hstack","gap"],[1,"p-2"],[1,"p-2","ms-auto"],["cButton","","color","secondary","variant","outline","routerLink","/ventes/devis/devis",3,"click"],["cButton","","color","dark",3,"click"],["cButton","","color","primary",3,"click"],["aria-hidden","true","size","sm"],["cIcon","","name","cilPlus"],[4,"ngTemplateOutlet"],["cButton","","color","secondary",3,"click","routerLink"],[1,"responsive-header",2,"color","#1d0528","font-family","'Times New Roman'","font-size","21px","margin-left","300px"],[1,"g-3"],["sm","4"],["cIcon","","name","cil-barcode",2,"color","blue","font-size","30px"],["cLabel","","for","code",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","code","type","text","placeholder","Code","name","code",3,"ngModelChange","blur","ngModel","valid"],[3,"valid"],["cIcon","","name","cil-calendar",2,"color","blue","font-size","30px"],["cLabel","","for","dateExperation",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","dateExperation","type","date","placeholder","DateExperation","name","dateExperation",3,"ngModelChange","blur","ngModel","valid"],["cLabel","","for","dateCreation",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","dateCreation","type","date","placeholder","DateCreation","name","dateCreation",3,"ngModelChange","blur","ngModel","valid"],["cLabel","","for","dateExpedition",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","dateExpedition","type","date","placeholder","DateExpedition","name","dateExpedition",3,"ngModelChange","blur","ngModel","valid"],["cIcon","","name","cil-sort-descending",2,"color","blue","font-size","30px"],["cLabel","","for","rabais",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","rabais","type","number","placeholder","Rabais","name","rabais",3,"ngModelChange","blur","ngModel","valid"],["cIcon","","name","cil-tags",2,"color","blue","font-size","30px"],["cLabel","","for","typeRabais",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cSelect","","id","typeRabais","name","typeRabais",3,"ngModelChange","blur","ngModel","valid"],[3,"value"],["cIcon","","name","cil-sort-ascending",2,"color","blue","font-size","30px"],["cLabel","","for","taxe",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cSelect","","id","taxe","name","taxe",3,"ngModelChange","blur","ngModel","valid"],["cButton","","color","secondary","type","button","variant","outline",3,"click"],["cLabel","","for","taxeExpedition",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cSelect","","id","taxeExpedition","name","taxeExpedition",3,"ngModelChange","blur","ngModel","valid"],["cIcon","","name","cilUser",2,"color","blue","font-size","30px"],["cLabel","","for","client",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cSelect","","id","client","name","client",3,"ngModelChange","blur","ngModel","valid"],["cIcon","","name","cil-dollar",2,"color","blue","font-size","30px"],["cLabel","","for","devises",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cSelect","","id","devises","name","devises",3,"ngModelChange","blur","ngModel","valid"],["cIcon","","name","cil-building",2,"color","blue","font-size","30px"],["cLabel","","for","entreprise",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","entreprise","type","text","name","entreprise","disabled","true",3,"value"],["align","middle","cTable","",1,"mb-0","border",3,"hover","responsive","striped"],[1,"text-nowrap","text-truncate"],[1,"bg-body-tertiary"],[1,"bg-body-tertiary",2,"display","flex","justify-content","end"],["sm","3",1,"mt-3"],["cSelect","","ngModel","",3,"ngModelChange"],[3,"ngValue"],["cLabel","","for","qte",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","qte","type","number","readonly","","name","qte",3,"value"],["cLabel","","for","sommeRemise",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","sommeRemise","type","number","readonly","","name","sommeRemise",3,"value"],["cLabel","","for","stotal",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","stotal","type","number","readonly","","name","stotal",3,"value"],["cLabel","","for","total",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","total","type","number","readonly","","name","total",3,"value"],["type","number",3,"ngModelChange","ngModel"],[2,"display","flex","justify-content","end"],["cButton","","color","",3,"click"],["cIcon","","name","cil-trash","size","lg"]],template:function(t,a){t&1&&(T(0,Xe,16,4),F(1,0,Oe),T(3,Ze,1,1),F(4,3,He),T(6,at,103,41,"ng-template",null,0,W)(8,st,56,13,"ng-template",null,1,W)),t&2&&(o(),N(a.standAlon),o(3),N(!a.standAlon))},dependencies:[ae,A,se,le,ye,Ce,be,_e,ge,fe,he,xe,oe,ee,te,ie,re,G,z,ne,pe],styles:['@charset "UTF-8";.responsive-header[_ngcontent-%COMP%]{font-family:Times New Roman;font-size:21px;margin-left:300px}@media (max-width: 1024px){.responsive-header[_ngcontent-%COMP%]{font-size:18px;margin-left:100px}}@media (max-width: 768px){.responsive-header[_ngcontent-%COMP%]{font-size:16px;margin-left:50px;text-align:center}}@media (max-width: 480px){.responsive-header[_ngcontent-%COMP%]{font-size:14px;margin-left:20px;text-align:center}}']});let l=m;return l})();export{si as DevisCreateComponent};
