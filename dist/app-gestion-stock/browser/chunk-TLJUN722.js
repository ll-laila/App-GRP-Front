import{a as Ce,b as xe,c as ye,d as we}from"./chunk-WWASLX2E.js";import"./chunk-2DCH5YPZ.js";import{a as ve}from"./chunk-2UXKBWAD.js";import{a as he}from"./chunk-AHUUM4CZ.js";import{a as N}from"./chunk-AWA5OIMR.js";import"./chunk-CW3XBB24.js";import"./chunk-SR3OXJX3.js";import{a as ge}from"./chunk-J5REKJTI.js";import{b as ne,c as re,f as oe,i as ae,j as se,k as le,m as me,n as ce}from"./chunk-RMR25O2K.js";import{a as pe,b as de}from"./chunk-5ID3IPCN.js";import{$ as ee,I as J,J as K,K as Q,L as X,P as Y,T as Z,U as B,_ as $,p as z,ta as te,ua as ie,v as U,w as j,y as q}from"./chunk-ETPUSV7N.js";import{c as R}from"./chunk-DKLNZNMU.js";import{a as M,b as fe}from"./chunk-OYMVH2NH.js";import{a as _e}from"./chunk-PTMIGOEM.js";import{a as ue}from"./chunk-PWEKJSU7.js";import"./chunk-KBKVWUMZ.js";import{d as O,e as H}from"./chunk-EVAI7AMW.js";import"./chunk-2BQUVQN4.js";import"./chunk-ROZ2NHZE.js";import"./chunk-VVDYSQS6.js";import"./chunk-LUIBGOM6.js";import{Cb as c,Ib as I,Kb as F,Lb as D,Mb as L,Nb as n,Ob as o,Pb as f,Sb as S,Tb as E,Wb as u,Yb as l,ec as T,fc as m,ga as C,gb as a,gc as v,hc as G,ka as W,lc as y,mc as w,nc as b,pc as P,va as d,vc as V,wa as _,wb as x,xa as g,xb as k,ya as h,yb as A}from"./chunk-BXK32XEB.js";import"./chunk-RGL3W33T.js";var be=()=>[B,import("./chunk-K4L4KWTC.js").then(r=>r.NgTemplateOutlet),z,H,ee,$,te,R],Ee=()=>[import("./chunk-K4L4KWTC.js").then(r=>r.NgTemplateOutlet)];function Se(r,p){if(r&1){let i=E();n(0,"c-nav-item",5)(1,"button",13),u("click",function(){d(i);let t=l(2);return _(t.retour())}),m(2,"Return"),o()()}if(r&2){let i=l(2);a(),c("routerLink",i.returnUrl)}}function Te(r,p){r&1&&f(0,"c-spinner",10)}function Ve(r,p){r&1&&(g(),f(0,"svg",11))}function Me(r,p){r&1&&S(0)}function ke(r,p){r&1&&S(0)}function Ae(r,p){r&1&&S(0)}function Ie(r,p){if(r&1){let i=E();n(0,"c-row",3)(1,"c-nav",4),x(2,Se,3,1,"c-nav-item",5),n(3,"c-nav-item",6)(4,"button",7),u("click",function(){d(i);let t=l();return _(t.cancel())}),m(5,"Annuler"),o()(),n(6,"c-nav-item",5)(7,"button",8),u("click",function(){d(i);let t=l();return _(t.reset())}),m(8,"R\xE9initialiser"),o()(),n(9,"c-nav-item",5)(10,"button",9),u("click",function(){d(i);let t=l();return _(t.create())}),x(11,Te,1,0,"c-spinner",10)(12,Ve,1,0,":svg:svg",11),m(13," Cr\xE9er "),o()()()(),x(14,Me,1,0,"ng-container",12)(15,ke,1,0,"ng-container",12)(16,Ae,1,0,"ng-container",12)}if(r&2){let i=l(),e=T(7),t=T(9),s=T(11);a(2),I(i.toReturn?2:-1),a(9),I(i.sending?11:12),a(3),c("ngTemplateOutlet",e),a(),c("ngTemplateOutlet",t),a(),c("ngTemplateOutlet",s)}}function Fe(r,p){r&1&&S(0)}function De(r,p){if(r&1&&x(0,Fe,1,0,"ng-container",12),r&2){l();let i=T(7);c("ngTemplateOutlet",i)}}function Le(r,p){if(r&1){let i=E();n(0,"c-card",3)(1,"c-card-header")(2,"strong",14),m(3,'Veuillez remplir les informations ci-dessous pour cr\xE9er un nouveau "Employ\xE9"'),o()(),n(4,"c-card-body")(5,"c-row",15)(6,"c-col",16),g(),f(7,"svg",17),h(),n(8,"label",18),m(9,"Code"),o(),n(10,"input",19),b("ngModelChange",function(t){d(i);let s=l();return w(s.item.code,t)||(s.item.code=t),_(t)}),u("blur",function(){d(i);let t=l();return _(t.validator.code.validate())}),o(),n(11,"c-form-feedback",20),m(12),o()(),n(13,"c-col",16),g(),f(14,"svg",17),h(),n(15,"label",21),m(16,"Password"),o(),n(17,"input",22),b("ngModelChange",function(t){d(i);let s=l();return w(s.item.password,t)||(s.item.password=t),_(t)}),u("blur",function(){d(i);let t=l();return _(t.validator.password.validate())}),o(),n(18,"c-form-feedback",20),m(19),o()(),n(20,"c-col",16),g(),f(21,"svg",23),h(),n(22,"label",24),m(23,"Nom "),o(),n(24,"input",25),b("ngModelChange",function(t){d(i);let s=l();return w(s.item.nom,t)||(s.item.nom=t),_(t)}),u("blur",function(){d(i);let t=l();return _(t.validator.nom.validate())}),o(),n(25,"c-form-feedback",20),m(26),o()(),n(27,"c-col",16),g(),f(28,"svg",23),h(),n(29,"label",24),m(30,"Pr\xE9nom "),o(),n(31,"input",26),b("ngModelChange",function(t){d(i);let s=l();return w(s.item.prenom,t)||(s.item.prenom=t),_(t)}),u("blur",function(){d(i);let t=l();return _(t.validator.prenom.validate())}),o(),n(32,"c-form-feedback",20),m(33),o()(),n(34,"c-col",16),g(),f(35,"svg",23),h(),n(36,"label",27),m(37,"Email "),o(),n(38,"input",28),b("ngModelChange",function(t){d(i);let s=l();return w(s.item.email,t)||(s.item.email=t),_(t)}),u("blur",function(){d(i);let t=l();return _(t.validator.email.validate())}),o(),n(39,"c-form-feedback",20),m(40),o()(),n(41,"c-col",16),g(),f(42,"svg",29),h(),n(43,"label",30),m(44,"T\xE9l\xE9phone"),o(),n(45,"input",31),b("ngModelChange",function(t){d(i);let s=l();return w(s.item.telephone,t)||(s.item.telephone=t),_(t)}),u("blur",function(){d(i);let t=l();return _(t.validator.telephone.validate())}),o(),n(46,"c-form-feedback",20),m(47),o()(),n(48,"c-col",16),g(),f(49,"svg",32),h(),n(50,"label",33),m(51,"Entreprise"),o(),n(52,"input",34),u("blur",function(){d(i);let t=l();return _(t.validator.code.validate())}),o(),n(53,"c-form-feedback",20),m(54),o()()()()()}if(r&2){let i=l();a(10),y("ngModel",i.item.code),c("valid",i.validator.code.valid),a(),c("valid",!1),a(),v(i.validator.code.message),a(5),y("ngModel",i.item.password),c("valid",i.validator.password.valid),a(),c("valid",!1),a(),v(i.validator.password.message),a(5),y("ngModel",i.item.nom),c("valid",i.validator.nom.valid),a(),c("valid",!1),a(),v(i.validator.nom.message),a(5),y("ngModel",i.item.prenom),c("valid",i.validator.prenom.valid),a(),c("valid",!1),a(),v(i.validator.prenom.message),a(5),y("ngModel",i.item.email),c("valid",i.validator.email.valid),a(),c("valid",!1),a(),v(i.validator.email.message),a(5),y("ngModel",i.item.telephone),c("valid",i.validator.telephone.valid),a(),c("valid",!1),a(),v(i.validator.telephone.message),a(5),c("value",i.item.entreprise==null?null:i.item.entreprise.nom)("valid",i.validator.code.valid),a(),c("valid",!1),a(),v(i.validator.code.message)}}function Re(r,p){if(r&1&&(n(0,"c-card",3)(1,"c-card-body"),f(2,"app-adresse-create",35),o()()),r&2){let i=l();a(2),c("getter",i.adresseGetter)("setter",i.adresseSetter)("validator",i.validator.adresse)}}function ze(r,p){if(r&1){let i=E();n(0,"tr")(1,"td"),m(2),o(),n(3,"td")(4,"button",44),u("click",function(){let t=d(i).$implicit,s=l(2);return _(s.openRolesModal(t))}),g(),n(5,"svg",45),f(6,"path",46),o()()(),h(),n(7,"td")(8,"button",44),u("click",function(){let t=d(i).$implicit,s=l(2);return _(s.removeFromPermissions(t))}),g(),f(9,"svg",47),o()()()}if(r&2){let i=p.$implicit;a(2),G(" ",i.nom!=null?i.nom:"null"," ")}}function Be(r,p){if(r&1&&(n(0,"option",43),m(1),o()),r&2){let i=p.$implicit;c("ngValue",i),a(),v(i.nom)}}function Ne(r,p){if(r&1){let i=E();n(0,"c-card",3)(1,"c-card-header")(2,"strong",36),m(3,"Permissions"),o()(),n(4,"c-card-body")(5,"table",37)(6,"thead",38)(7,"tr")(8,"th",39),m(9,"Entreprise"),o(),n(10,"th",39),m(11,"roles"),o(),n(12,"th",39),m(13,"\xE9liminer"),o()()(),n(14,"tbody"),D(15,ze,10,1,"tr",null,F),o()(),n(17,"app-roles-list",40),u("confirmed",function(t){d(i);let s=l();return _(s.handleRoles(t))}),o(),n(18,"c-col",41)(19,"c-input-group")(20,"select",42),u("ngModelChange",function(t){d(i);let s=l();return _(s.addToPermessions(t))}),D(21,Be,2,2,"option",43,F),o()()()()()}if(r&2){let i=l();a(5),c("hover",!0)("responsive",!0)("striped",!0),a(10),L(i.entreprisesAdroitAcces),a(2),c("permissions",i.permissions),a(4),L(i.entrepriseList)}}var dt=(()=>{let p=class p{constructor(){this.sending=!1,this.standAlon=!0,this.permissions=[],this.router=C(O),this.entrepriseSelectedService=C(_e),this.userInfosService=C(ue),this.service=C(fe),this.entrepriseService=C(de),this.formBuilder=C(me),this.validator=Ce.init(()=>this.item).setAdresse(he.init(()=>this.adresse)),this.toasterService=C(ge),this.currentCodeNumber=1,this.adresseGetter=()=>this.adresse,this.adresseSetter=e=>this.adresse=e}set setItemGetter(e){this.itemGetter=e,this.standAlon=!1}set setItemSetter(e){this.itemSetter=e}set setValidator(e){this.validator=e}ngOnInit(){this.loadEntreprise(),this.service.keepData||this.reset(!1),this.service.keepData=!1,this.item.adresse=new N,this.loadEntrepriseList(),this.clientForm=this.formBuilder.group({code:[{value:this.generateCode(),disabled:!0}]}),this.service.getNextCode().subscribe({next:e=>this.item.code=e.code,error:e=>console.log(e)})}generateCode(){return"I"+this.currentCodeNumber.toString().padStart(7,"0")}loadEntreprise(){this.entrepriseService.findById(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>{this.item.entreprise=e,console.log("entre :",this.item.entreprise)},error:e=>console.log(e)})}loadEntrepriseList(){this.entrepriseService.findByAdmin(this.userInfosService.getUsername()).subscribe(e=>{console.log(e),this.entrepriseList=e},e=>{console.log(e)})}create(){console.log(this.item),!this.toasterService.validateThenToast(this.validator)&&(this.sending=!0,this.item.admin=this.userInfosService.getUsername(),this.service.create().subscribe({next:e=>{if(this.sending=!1,e!=null){if(this.toReturn){this.item=e,this.router.navigate([this.returnUrl]).then();return}this.item=new M,this.router.navigate(["/contacts/user/employe"]).then(),this.toasterService.toast({message:"Un nouveau employe a \xE9t\xE9 ajout\xE9",color:"success"})}},error:e=>{this.sending=!1,console.log(e),this.validator.import(e.error)}}))}getEntrepriseById(e){this.entrepriseService.findById(e).subscribe(t=>{this.Entrep=t})}addToPermessions(e){this.item.entreprisesAdroitAcces==null&&(this.item.entreprisesAdroitAcces=[]),this.item.entreprisesAdroitAcces=[...this.item.entreprisesAdroitAcces,e],console.log(this.item.entreprisesAdroitAcces)}removeFromPermissions(e){this.item.entreprisesAdroitAcces=this.item.entreprisesAdroitAcces?.filter(t=>t!==e)}openRolesModal(e){this.selectedEntreprise=e;let t=document.getElementById("confirmationModal");t&&new xe(t).show()}handleRoles(e){this.permissions=e,this.item.permissionsAcces=this.permissions.map(t=>{let s=new we;return s.nom=t.nom,s.etat=t.etat,s.entrepriseId=this.selectedEntreprise.id,s})}reset(e=!0){(e||this.item==null)&&(this.item=new M),this.validator.reset()}get entreprisesAdroitAcces(){return this.item.entreprisesAdroitAcces==null&&(this.item.entreprisesAdroitAcces=[]),this.item.entreprisesAdroitAcces}set entreprisesAdroitAcces(e){this.item.entreprisesAdroitAcces=e}get permissionsAcces(){return this.item.permissionsAcces==null&&(this.item.permissionsAcces=[]),this.item.permissionsAcces}set permissionsAcces(e){this.item.permissionsAcces=e}get items(){return this.service.items}set items(e){this.service.items=e}get item(){return this.itemGetter()}set item(e){this.itemSetter(e)}itemGetter(){return this.service.item}itemSetter(e){this.service.item=e}get adresse(){return this.item.adresse==null&&(this.item.adresse=new N),this.item.adresse}set adresse(e){this.item.adresse=e}get entreprise(){return this.item.entreprise==null&&(this.item.entreprise=new pe),this.item.entreprise}set entreprise(e){this.item.entreprise=e}get returnUrl(){return this.service.returnUrl}get toReturn(){return this.service.toReturn()}navigateToEntrepriseCreate(){this.entrepriseService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/parametres/entreprise/create"]).then()}cancel(){this.item=new M}retour(){this.router.navigate(["/contacts/user/employe/list"]).then()}};p.\u0275fac=function(t){return new(t||p)},p.\u0275cmp=W({type:p,selectors:[["app-employe-create"]],inputs:{permissions:"permissions",setItemGetter:[0,"getter","setItemGetter"],setItemSetter:[0,"setter","setItemSetter"],setValidator:[0,"validator","setValidator"]},standalone:!0,features:[P],decls:12,vars:2,consts:[["createFrom",""],["createSubEntities",""],["permission",""],[1,"mb-3"],[1,"hstack","gap"],[1,"p-2"],[1,"p-2","ms-auto"],["cButton","","color","secondary","variant","outline","routerLink","/contacts/user/employe",3,"click"],["cButton","","color","dark",3,"click"],["cButton","","color","primary",3,"click"],["aria-hidden","true","size","sm"],["cIcon","","name","cilPlus"],[4,"ngTemplateOutlet"],["cButton","","color","secondary",3,"click","routerLink"],[1,"responsive-header",2,"color","#1d0528","font-family","'Times New Roman'","font-size","21px","margin-left","300px"],[1,"g-3"],["sm","4"],["cIcon","","name","cil-barcode",2,"color","blue","font-size","30px"],["cLabel","","for","code",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","code","type","text","name","code","disabled","true",2,"background-color","#ffffff",3,"ngModelChange","blur","ngModel","valid"],[3,"valid"],["cLabel","","for","pass",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","pass","type","password","name","code",3,"ngModelChange","blur","ngModel","valid"],["cIcon","","name","cilUser",2,"color","blue","font-size","30px"],["cLabel","","for","nom",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","nom","type","text","name","nom",3,"ngModelChange","blur","ngModel","valid"],["cFormControl","","id","prenom","type","text","name","prenom",3,"ngModelChange","blur","ngModel","valid"],["cLabel","","for","kk",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","kk","type","text","name","prenom",3,"ngModelChange","blur","ngModel","valid"],["cIcon","","name","cil-phone",2,"color","blue","font-size","30px"],["cLabel","","for","telephone",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","telephone","type","text","name","telephone",3,"ngModelChange","blur","ngModel","valid"],["cIcon","","name","cil-building",2,"color","blue","font-size","30px"],["cLabel","","for","entreprise",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","entreprise","type","text","name","entreprise","disabled","true",3,"blur","value","valid"],[3,"getter","setter","validator"],[2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["align","middle","cTable","",1,"mb-0","border",3,"hover","responsive","striped"],[1,"text-nowrap","text-truncate"],[1,"bg-body-tertiary"],[3,"confirmed","permissions"],["sm","3",1,"mt-3"],["cSelect","","ngModel","",3,"ngModelChange"],[3,"ngValue"],["cButton","","color","",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-ui-checks-grid"],["d","M2 10h3a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1m9-9h3a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-3a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1m0 9a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1zm0-10a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h3a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM2 9a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h3a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2zm7 2a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2h-3a2 2 0 0 1-2-2zM0 2a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm5.354.854a.5.5 0 1 0-.708-.708L3 3.793l-.646-.647a.5.5 0 1 0-.708.708l1 1a.5.5 0 0 0 .708 0z"],["cIcon","","name","cil-trash","size","lg"]],template:function(t,s){t&1&&(x(0,Ie,17,5),k(1,0,be),x(3,De,1,1),k(4,3,Ee),x(6,Le,55,28,"ng-template",null,0,V)(8,Re,3,3,"ng-template",null,1,V)(10,Ne,23,4,"ng-template",null,2,V)),t&2&&(a(),A(s.standAlon),a(3),A(!s.standAlon))},dependencies:[Q,B,Z,Y,ce,se,le,ne,ae,re,oe,X,U,j,q,K,z,R,J,ve,ie,ye],styles:['@charset "UTF-8";.responsive-header[_ngcontent-%COMP%]{font-family:Times New Roman;font-size:21px;margin-left:300px}@media (max-width: 1024px){.responsive-header[_ngcontent-%COMP%]{font-size:18px;margin-left:100px}}@media (max-width: 768px){.responsive-header[_ngcontent-%COMP%]{font-size:16px;margin-left:50px;text-align:center}}@media (max-width: 480px){.responsive-header[_ngcontent-%COMP%]{font-size:14px;margin-left:20px;text-align:center}}']});let r=p;return r})();export{dt as EmployeCreateComponent};
