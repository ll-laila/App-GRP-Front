import{a as Be,b as y}from"./chunk-EXOHPXTY.js";import{a as I,b as Fe}from"./chunk-OKSUT35I.js";import{b as ke}from"./chunk-D6WZ5UA2.js";import{a as O}from"./chunk-UBDUPB6Y.js";import{a as Te,b as Ie}from"./chunk-LDMW65QK.js";import{a as Le}from"./chunk-J5REKJTI.js";import{a as N,b as be}from"./chunk-GTWPVTZV.js";import{b as we}from"./chunk-HA5FO7LC.js";import{a as Ee,b as ye}from"./chunk-ZV6L5X3B.js";import{b as ce,c as de,f as pe,i as ue,j as he,k as fe,m as ve,n as xe}from"./chunk-RMR25O2K.js";import{a as ge,b as Ce}from"./chunk-5ID3IPCN.js";import{$ as ae,I as Z,J as ee,K as te,L as ie,P as ne,T as re,U as z,_ as oe,p as R,ta as se,ua as le,v as K,w as X,y as Y}from"./chunk-ETPUSV7N.js";import{c as M}from"./chunk-DKLNZNMU.js";import{a as Se}from"./chunk-PTMIGOEM.js";import{d as Q,e as J}from"./chunk-EVAI7AMW.js";import{a as _e}from"./chunk-2BQUVQN4.js";import{a as me}from"./chunk-ROZ2NHZE.js";import{b as q}from"./chunk-LUIBGOM6.js";import{Cb as f,Ib as B,Jb as A,Kb as W,Lb as P,Mb as V,Nb as n,Nd as H,Ob as r,Pb as x,Sb as w,Tb as L,Wb as _,Yb as c,aa as G,ec as T,fc as a,ga as d,gb as s,gc as h,hc as $,ka as U,lc as S,mc as b,nc as E,pc as j,va as p,vc as D,wa as u,wb as v,xa as g,xb as k,ya as C,yb as F}from"./chunk-BXK32XEB.js";var Pe=(()=>{let l=class l{constructor(){this.api=me.apiUrl+"livraisonproduit",this.http=d(q),this.keepData=!1,this.toReturn=()=>this.returnUrl!=null}findAll(){return this.http.get(this.api)}findById(e){return this.http.get(`${this.api}/id/${e}`)}findAllOptimized(){return this.http.get(`${this.api}/optimized`)}findPaginated(e=0,t=10){return this.http.get(`${this.api}/paginated?page=${e}&size=${t}`)}create(){return this.http.post(this.api,this.item)}createList(){return this.http.post(`${this.api}/all`,this.items)}update(){return this.http.put(this.api,this.item)}updateList(){return this.http.put(`${this.api}/all`,this.items)}delete(e){return this.http.delete(this.api,{body:e})}deleteAll(e){return this.http.delete(this.api,{body:e})}deleteById(e){return this.http.delete(`${this.api}/id/${e}`)}deleteByProduitId(e){return this.http.delete(`${this.api}/produit/${e}`)}findByProduitId(e){return this.http.get(`${this.api}/produit/${e}`)}deleteByLivraisonId(e){return this.http.delete(`${this.api}/livraison/${e}`)}findByLivraisonId(e){return this.http.get(`${this.api}/livraison/${e}`)}get itemIsNull(){return this._item==null}get items(){return this._items==null&&(this._items=[]),this._items}get pagination(){return this._pagination==null&&(this._pagination=new _e),this._pagination}set pagination(e){this._pagination=e}set items(e){this._items=e}get item(){return this._item==null&&(this._item=new y),this._item}set item(e){this._item=e}get createdItemAfterReturn(){let e={item:this.item,created:this.toReturn()};return this.returnUrl="",this.item=new y,e}getNextCode(){return this.http.get(`${this.api}/next-code`)}};l.\u0275fac=function(t){return new(t||l)},l.\u0275prov=G({token:l,factory:l.\u0275fac,providedIn:"root"});let o=l;return o})();var Me=()=>[z,import("./chunk-K4L4KWTC.js").then(o=>o.NgTemplateOutlet),R,J,ae,oe,se,M],Re=()=>[import("./chunk-K4L4KWTC.js").then(o=>o.NgTemplateOutlet)];function ze(o,l){if(o&1){let i=L();n(0,"c-nav-item",4)(1,"button",12),_("click",function(){p(i);let t=c(2);return u(t.retour())}),a(2,"Return"),r()()}if(o&2){let i=c(2);s(),f("routerLink",i.returnUrl)}}function Ne(o,l){o&1&&x(0,"c-spinner",9)}function Oe(o,l){o&1&&(g(),x(0,"svg",10))}function Ge(o,l){o&1&&w(0)}function Ue(o,l){o&1&&w(0)}function Ae(o,l){if(o&1){let i=L();n(0,"c-row",2)(1,"c-nav",3),v(2,ze,3,1,"c-nav-item",4),n(3,"c-nav-item",5)(4,"button",6),_("click",function(){p(i);let t=c();return u(t.cancel())}),a(5,"Annuler"),r()(),n(6,"c-nav-item",4)(7,"button",7),_("click",function(){p(i);let t=c();return u(t.reset())}),a(8,"R\xE9initialiser"),r()(),n(9,"c-nav-item",4)(10,"button",8),_("click",function(){p(i);let t=c();return u(t.create())}),v(11,Ne,1,0,"c-spinner",9)(12,Oe,1,0,":svg:svg",10),a(13,`
Cr\xE9er
`),r()()()(),v(14,Ge,1,0,"ng-container",11)(15,Ue,1,0,"ng-container",11)}if(o&2){let i=c(),e=T(7),t=T(9);s(2),B(i.toReturn?2:-1),s(9),B(i.sending?11:12),s(3),f("ngTemplateOutlet",e),s(),f("ngTemplateOutlet",t)}}function We(o,l){o&1&&w(0)}function $e(o,l){if(o&1&&v(0,We,1,0,"ng-container",11),o&2){c();let i=T(7);f("ngTemplateOutlet",i)}}function je(o,l){if(o&1&&(n(0,"option",26),a(1),r()),o&2){let i=l.$implicit;f("value",i.id),s(),h(i.nom)}}function He(o,l){if(o&1&&(n(0,"option",26),a(1),r()),o&2){let i=l.$implicit;f("value",i.id),s(),h(i.code)}}function qe(o,l){if(o&1){let i=L();n(0,"c-card",2)(1,"c-card-header")(2,"strong",13),a(3,"Veuillez remplir les informations ci-dessous pour cr\xE9er un Bon de livraison"),r()(),n(4,"c-card-body")(5,"c-row",14)(6,"c-col",15),g(),x(7,"svg",16),C(),n(8,"label",17),a(9,"Code"),r(),n(10,"input",18),E("ngModelChange",function(t){p(i);let m=c();return b(m.item.code,t)||(m.item.code=t),u(t)}),r()(),n(11,"c-col",15)(12,"label",19),a(13,"Date de Cr\xE9ation"),r(),n(14,"input",20),E("ngModelChange",function(t){p(i);let m=c();return b(m.item.dateCreation,t)||(m.item.dateCreation=t),u(t)}),r()(),n(15,"c-col",15)(16,"label",21),a(17,"Date d'Expedition"),r(),n(18,"input",22),E("ngModelChange",function(t){p(i);let m=c();return b(m.item.dateExpedition,t)||(m.item.dateExpedition=t),u(t)}),r()(),n(19,"c-col",15),g(),x(20,"svg",23),C(),n(21,"label",24),a(22,"Fournisseur"),r(),n(23,"c-input-group")(24,"select",25),E("ngModelChange",function(t){p(i);let m=c();return b(m.fournisseur.id,t)||(m.fournisseur.id=t),u(t)}),_("change",function(){p(i);let t=c();return u(t.selectFournisseur())}),P(25,je,2,2,"option",26,W),r(),n(27,"button",27),_("click",function(){p(i);let t=c();return u(t.navigateToFournisseurCreate())}),g(),x(28,"svg",10),r()()(),C(),n(29,"c-col",15),g(),x(30,"svg",28),C(),n(31,"label",29),a(32,"Entreprise"),r(),n(33,"input",30),_("blur",function(){p(i);let t=c();return u(t.validator.code.validate())}),r(),n(34,"c-form-feedback",31),a(35),r()(),n(36,"c-col",15),g(),x(37,"svg",28),C(),n(38,"label",32),a(39,"Code Bon de Commande"),r(),n(40,"c-input-group")(41,"select",33),_("change",function(t){p(i);let m=c();return u(m.selectBonComd(t))}),v(42,He,2,2,"option",34),r()()()()()()}if(o&2){let i=c();s(10),S("ngModel",i.item.code),s(4),S("ngModel",i.item.dateCreation),s(4),S("ngModel",i.item.dateExpedition),s(6),S("ngModel",i.fournisseur.id),s(),V(i.fournisseurList),s(8),f("value",i.item.entreprise==null?null:i.item.entreprise.nom)("valid",i.validator.code.valid),s(),f("valid",!1),s(),h(i.validator.code.message),s(7),f("ngForOf",i.bonCommandeList)("ngForTrackBy",i.trackById)}}function Qe(o,l){if(o&1&&(n(0,"tr")(1,"td"),a(2),r(),n(3,"td"),a(4),r(),n(5,"td"),a(6),r(),n(7,"td"),a(8),r(),n(9,"td"),a(10),r(),n(11,"td",40)(12,"button",41),g(),x(13,"svg",42),r()()()),o&2){let i=l.$implicit;s(2),$(" ",i.produit!=null?i.produit.nom:"null"," "),s(2),h(i.prix),s(2),h(i.total),s(2),h(i.quantite),s(2),h(i.disque)}}function Je(o,l){if(o&1&&(n(0,"c-card",2)(1,"c-card-header")(2,"strong",35),a(3,"S\xE9lectionner des produits"),r()(),n(4,"c-card-body")(5,"table",36)(6,"thead",37)(7,"tr")(8,"th",38),a(9,"Produit"),r(),n(10,"th",38),a(11,"Prix"),r(),n(12,"th",38),a(13,"Total"),r(),n(14,"th",38),a(15,"Quantite"),r(),n(16,"th",38),a(17,"Remise"),r(),n(18,"th",39),a(19,"Actions"),r()()(),n(20,"tbody"),P(21,Qe,14,5,"tr",null,A),r()()()(),n(23,"c-card",2)(24,"c-card-header")(25,"strong",35),a(26,"Informations supplimentaire"),r()(),n(27,"c-card-body")(28,"table",36)(29,"thead",37)(30,"tr")(31,"th",38),a(32,"Unit\xE9s total"),r(),n(33,"th",38),a(34,"Remise Global"),r(),n(35,"th",38),a(36,"Taxe"),r(),n(37,"th",38),a(38,"Sous total"),r(),n(39,"th",38),a(40,"Total"),r()()(),n(41,"tbody")(42,"tr")(43,"td"),a(44),r(),n(45,"td"),a(46),r(),n(47,"td"),a(48),r(),n(49,"td"),a(50),r(),n(51,"td"),a(52),r()()()()()()),o&2){let i=c();s(5),f("hover",!0)("responsive",!0)("striped",!0),s(16),V(i.livraisonProduit),s(7),f("hover",!0)("responsive",!0)("striped",!0),s(16),h(i.item.totalUnites),s(2),h(i.item.remiseGlobal),s(2),h(i.item.taxeExpedition==null?null:i.item.taxeExpedition.nom),s(2),h(i.item.sousTotal),s(2),h(i.item.total)}}var Dt=(()=>{let l=class l{constructor(){this.sending=!1,this.standAlon=!0,this.router=d(Q),this.service=d(Fe),this.taxeService=d(Ie),this.fournisseurService=d(ye),this.entrepriseService=d(Ce),this.livraisonProduitService=d(Pe),this.bonCommandeProduitService=d(ke),this.bonCommandeService=d(be),this.formBuilder=d(ve),this.toasterService=d(Le),this.produitService=d(we),this.entrepriseSelectedService=d(Se),this.validator=Be.init(()=>this.item),this.typeRabaisEnumList=Object.values(O),this.TypeRabaisEnum=O,this.bonCommandeList=[],this.bonCommandeSelected=new N}set setItemGetter(e){this.itemGetter=e,this.standAlon=!1}set setItemSetter(e){this.itemSetter=e}set setValidator(e){this.validator=e}ngOnInit(){if(this.loadEntreprise(),this.service.keepData){let e=this.taxeService.createdItemAfterReturn;e.created&&(this.item.taxeExpedition=e.item,this.validator.taxeExpedition.validate());let t=this.fournisseurService.createdItemAfterReturn;t.created&&(this.item.fournisseur=t.item,this.validator.fournisseur.validate())}else this.reset(!1);this.service.keepData=!1,this.generateCode(),this.loadTaxeList(),this.loadFournisseurList()}create(){console.log(this.item),this.service.create().subscribe({next:e=>{this.item=e,this.item=new I,this.router.navigate(["/inventaire/livraison/livraison/livraisonpdf"]).then(),this.toasterService.toast({message:"Un nouveau livraison a \xE9t\xE9 ajout\xE9",color:"success"})},error:e=>{this.sending=!1,console.log(e),this.validator.import(e.error)}})}generateCode(){let e=Math.floor(Math.random()*1e6);this.item.code="L"+e.toString().padStart(6,"0")}loadEntreprise(){this.entrepriseService.findById(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>{this.item.entreprise=e,console.log("entre :",this.item.entreprise)},error:e=>console.log(e)})}loadTaxeList(){this.taxeService.findAllOptimized().subscribe({next:e=>this.taxeList=e,error:e=>console.log(e)})}loadFournisseurList(){this.fournisseurService.getFournisseurs(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>{this.fournisseurList=e},error:e=>console.log(e)})}reset(e=!0){(e||this.item==null)&&(this.item=new I),this.validator.reset()}navigateToTaxeCreate(){this.taxeService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/parametres/taxe/create"]).then()}navigateToFournisseurCreate(){this.fournisseurService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/contacts/fournisseur/create"]).then()}navigateToEntrepriseCreate(){this.entrepriseService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/parametres/entreprise/create"]).then()}navigateToBonCommandeCreate(){this.entrepriseService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/inventaire/boncommande/create"]).then()}cancel(){this.item=new I}retour(){this.router.navigate(["/pays/pays/list"]).then()}get returnUrl(){return this.service.returnUrl}get toReturn(){return this.service.toReturn()}deleteFactureProduit(e){this.item.livraisonProduit=this.item.livraisonProduit?.filter(t=>t!==e)}findBncmd(){this.bonCommandeService.findById(this.item.bonCommande?.id).subscribe({next:e=>{this.item.bonCommande=e,this.item.fournisseur=e.fournisseur,this.item.dateCreation=e.dateCreation,this.item.dateExpedition=e.dateExpedition,this.item.entreprise=e.entreprise},error:e=>console.log(e)})}selectBonComd(e){let t=e.target.value,m=this.bonCommandeList.find(Ve=>Ve.id===parseInt(t,10));m&&(this.bonCommandeSelected=m,this.mapBonCommandeToLivraison(m))}mapBonCommandeToLivraison(e){this.item.bonCommande=e,console.log(e),this.item.fournisseur=e.fournisseur,this.item.dateCreation=e.dateCreation,this.item.dateExpedition=e.dateExpedition,this.item.entreprise=e.entreprise,this.item.totalUnites=e.totalUnites,this.item.remiseGlobal=e.remiseGlobal,this.item.sousTotal=e.sousTotal,this.item.total=e.total,this.item.taxeExpedition=e.taxeExpedition,this.item.livraisonProduit=e.bonCommandeProduit?.map(t=>{let m=new y;return m.id=t.id,m.total=t.total,m.quantite=t.quantite,m.disque=t.disque,m.produit=t.produit,m.prix=t.prix,console.log(m.prix),m})||[]}trackById(e,t){return t.id}get livraisonProduit(){return this.item.livraisonProduit||(this.item.livraisonProduit=[]),this.item.livraisonProduit}selectFournisseur(){this.boncmds(this.fournisseur.id)}boncmds(e){this.bonCommandeService.findByIdFor(e).subscribe({next:t=>{this.bonCommandeList=t},error:t=>{console.log(t)}})}get items(){return this.service.items}set items(e){this.service.items=e}get item(){return this.itemGetter()}set item(e){this.itemSetter(e)}itemGetter(){return this.service.item}itemSetter(e){this.service.item=e}get taxeExpedition(){return this.item.taxeExpedition==null&&(this.item.taxeExpedition=new Te),this.item.taxeExpedition}set taxeExpedition(e){this.item.taxeExpedition=e}get fournisseur(){return this.item.fournisseur==null&&(this.item.fournisseur=new Ee),this.item.fournisseur}set fournisseur(e){this.item.fournisseur=e}get entreprise(){return this.item.entreprise==null&&(this.item.entreprise=new ge),this.item.entreprise}set entreprise(e){this.item.entreprise=e}get bonCmd(){return this.item.bonCommande==null&&(this.item.bonCommande=new N),this.item.bonCommande}set bonCmd(e){this.item.bonCommande=e}set itemsLP(e){this.livraisonProduitService.items=e}get itemLP(){return this.livraisonProduitService.item}set itemLP(e){this.livraisonProduitService.item=e}set cmdprds(e){this.bonCommandeProduitService.items=e}get cmdprd(){return this.bonCommandeProduitService.item}set cmdprd(e){this.bonCommandeProduitService.item=e}set bnCmds(e){this.bonCommandeService.items=e}get bnCmd(){return console.log(this.bonCommandeService.item),this.bonCommandeService.item}get bonCommandeProduit(){return console.log(this.bonCommandeService.item.bonCommandeProduit),this.bonCommandeService.item.bonCommandeProduit}set bnCmd(e){this.bonCommandeService.item=e}};l.\u0275fac=function(t){return new(t||l)},l.\u0275cmp=U({type:l,selectors:[["app-livraison-create"]],inputs:{setItemGetter:[0,"getter","setItemGetter"],setItemSetter:[0,"setter","setItemSetter"],setValidator:[0,"validator","setValidator"]},standalone:!0,features:[j],decls:10,vars:2,consts:[["createFrom",""],["livraisonProduitCreate",""],[1,"mb-3"],[1,"hstack","gap"],[1,"p-2"],[1,"p-2","ms-auto"],["cButton","","color","secondary","variant","outline","routerLink","/inventaire/livraison/livraison",3,"click"],["cButton","","color","dark",3,"click"],["cButton","","color","primary",3,"click"],["aria-hidden","true","size","sm"],["cIcon","","name","cilPlus"],[4,"ngTemplateOutlet"],["cButton","","color","secondary",3,"click","routerLink"],[1,"responsive-header",2,"color","#1d0528","font-family","'Times New Roman'","font-size","21px","margin-left","300px"],[1,"g-3"],["sm","4"],["cIcon","","name","cil-barcode",2,"color","blue","font-size","30px"],["cLabel","","for","code",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","code","type","text","placeholder","Code","name","code",3,"ngModelChange","ngModel"],["cLabel","","for","dateCreation",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","dateCreation","type","date","placeholder","DateCreation","name","dateCreation",3,"ngModelChange","ngModel"],["cLabel","","for","dateExpedition",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","dateExpedition","type","date","placeholder","DateExpedition","name","dateExpedition",3,"ngModelChange","ngModel"],["cIcon","","name","cilUser",2,"color","blue","font-size","30px"],["cLabel","","for","fournisseur",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cSelect","","id","fournisseur","name","fournisseur",3,"ngModelChange","change","ngModel"],[3,"value"],["cButton","","color","secondary","type","button","variant","outline",3,"click"],["cIcon","","name","cil-building",2,"color","blue","font-size","30px"],["cLabel","","for","entreprise",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","entreprise","type","text","name","entreprise","disabled","true",3,"blur","value","valid"],[3,"valid"],["cLabel","","for","bndCommande",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cSelect","","id","bndCommande","name","bndCommande",3,"change"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["align","middle","cTable","",1,"mb-0","border",3,"hover","responsive","striped"],[1,"text-nowrap","text-truncate"],[1,"bg-body-tertiary"],[1,"bg-body-tertiary",2,"display","flex","justify-content","end"],[2,"display","flex","justify-content","end"],["cButton","","color",""],["cIcon","","name","cil-trash","size","lg"]],template:function(t,m){t&1&&(v(0,Ae,16,4),k(1,0,Me),v(3,$e,1,1),k(4,3,Re),v(6,qe,43,10,"ng-template",null,0,D)(8,Je,53,11,"ng-template",null,1,D)),t&2&&(s(),F(m.standAlon),s(3),F(!m.standAlon))},dependencies:[te,z,re,ne,xe,he,fe,ce,ue,de,pe,ie,K,X,Y,ee,R,M,Z,le,H],styles:['@charset "UTF-8";.responsive-header[_ngcontent-%COMP%]{font-family:Times New Roman;font-size:21px;margin-left:300px}@media (max-width: 1024px){.responsive-header[_ngcontent-%COMP%]{font-size:18px;margin-left:100px}}@media (max-width: 768px){.responsive-header[_ngcontent-%COMP%]{font-size:16px;margin-left:50px;text-align:center}}@media (max-width: 480px){.responsive-header[_ngcontent-%COMP%]{font-size:14px;margin-left:20px;text-align:center}}']});let o=l;return o})();export{Dt as a};
