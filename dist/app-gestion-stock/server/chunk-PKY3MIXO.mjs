import './polyfills.server.mjs';
import{a as de,b as he,c as fe,d as ge}from"./chunk-DGTYMJ3W.mjs";import{a as pe,b as ue}from"./chunk-OR4ZYGNA.mjs";import{a as ae,b as me}from"./chunk-4O54P57Y.mjs";import{a as ne,b as oe}from"./chunk-KUWVGZID.mjs";import{c as Z,f as $,i as ee,j as te,k as ie,n as re}from"./chunk-MG5ECMPI.mjs";import{B as j,C as H,D as z,E as q,M as J,N as P,T as K,U as Q,i as I,ma as X,o as O,p as W}from"./chunk-BJSQRMLK.mjs";import{c as w}from"./chunk-TMD5LWM3.mjs";import{a as Y}from"./chunk-JCP3ZGLC.mjs";import{b as ce}from"./chunk-TJ3A5ET5.mjs";import{a as se}from"./chunk-NLO6QWTG.mjs";import{a as le}from"./chunk-WHNHYHSL.mjs";import{e as G,f as N}from"./chunk-AO72HDTW.mjs";import{Ab as S,Eb as f,Kb as b,Mb as k,Nb as U,Ob as F,Pb as a,Qb as m,Rb as g,Ub as x,Vb as R,Yb as _,_b as l,ga as c,gc as y,hb as o,hc as h,ic as E,ka as T,nc as V,oc as A,pc as L,rc as M,va as u,wa as d,xa as v,xc as B,ya as D,yb as p,zb as C}from"./chunk-NYO24GET.mjs";var _e=()=>[P,import("./chunk-FBVZH4FD.mjs").then(i=>i.NgTemplateOutlet),I,N,Q,K,X,w],ve=()=>[import("./chunk-FBVZH4FD.mjs").then(i=>i.NgTemplateOutlet)];function Ce(i,n){i&1&&g(0,"c-spinner",7)}function Se(i,n){i&1&&(v(),g(0,"svg",8))}function be(i,n){i&1&&g(0,"c-spinner",7)}function xe(i,n){i&1&&(v(),g(0,"svg",10))}function Re(i,n){i&1&&x(0)}function ye(i,n){if(i&1){let r=R();a(0,"c-row",1)(1,"c-nav",2)(2,"c-nav-item",3)(3,"button",4),_("click",function(){u(r);let t=l();return d(t.cancel())}),h(4,"Annuler "),m()(),a(5,"c-nav-item",5)(6,"button",6),_("click",function(){u(r);let t=l();return d(t.reset())}),p(7,Ce,1,0,"c-spinner",7)(8,Se,1,0,":svg:svg",8),h(9," Reset "),m()(),a(10,"c-nav-item",5)(11,"button",9),_("click",function(){u(r);let t=l();return d(t.update())}),p(12,be,1,0,"c-spinner",7)(13,xe,1,0,":svg:svg",10),h(14," Modifier "),m()()()(),p(15,Re,1,0,"ng-container",11)}if(i&2){let r=l(),e=y(7);o(7),b(r.resetting?7:8),o(5),b(r.sending?12:13),o(3),f("ngTemplateOutlet",e)}}function Ee(i,n){i&1&&x(0)}function we(i,n){if(i&1&&p(0,Ee,1,0,"ng-container",11),i&2){l();let r=y(7);f("ngTemplateOutlet",r)}}function Ie(i,n){if(i&1&&(a(0,"option",16),h(1),m()),i&2){let r=n.$implicit;f("value",r.id),o(),E(r.code)}}function Pe(i,n){if(i&1){let r=R();a(0,"c-card",1)(1,"c-card-body")(2,"c-row",12)(3,"c-col",13)(4,"label",14),h(5,"Client"),m(),a(6,"c-input-group")(7,"select",15),L("ngModelChange",function(t){u(r);let s=l();return A(s.client.id,t)||(s.client.id=t),d(t)}),_("blur",function(){u(r);let t=l();return d(t.validator.client.validate())}),U(8,Ie,2,2,"option",16,k),m(),a(10,"button",17),_("click",function(){u(r);let t=l();return d(t.navigateToClientCreate())}),v(),g(11,"svg",18),m(),D(),a(12,"c-form-feedback",19),h(13),m()()()()()()}if(i&2){let r=l();o(7),V("ngModel",r.client.id),f("valid",r.validator.client.valid),o(),F(r.clientList),o(4),f("valid",!1),o(),E(r.validator.client.message)}}var nt=(()=>{let n=class n{constructor(){this.isPartOfUpdateForm=!1,this.sending=!1,this.resetting=!1,this.standAlon=!0,this.router=c(G),this.service=c(ue),this.clientService=c(me),this.entrepriseService=c(oe),this.userInfosService=c(le),this.tokenService=c(Y),this.employeService=c(ce),this.entrepriseSelectedService=c(se),this.validator=de.init(()=>this.item),this.noteCreditGetter=()=>this.noteCredit,this.noteCreditSetter=e=>this.noteCredit=e,this.remboursementsGetter=()=>this.remboursements,this.remboursementsSetter=e=>this.remboursements=e,this.statutRetourProduitEnumList=Object.values(ge)}set setItemGetter(e){this.itemGetter=e,this.standAlon=!1}set setItemSetter(e){this.itemSetter=e}set setValidator(e){this.validator=e}ngAfterContentInit(){!this.isPartOfUpdateForm&&this.item.id==null&&this.router.navigate(["/ventes/retourproduit/retour-produit"]).then()}ngOnInit(){if(this.service.keepData){let t=this.clientService.createdItemAfterReturn;t.created&&(this.item.client=t.item,this.validator.client.validate())}else this.validator.reset();this.loadEntrepriseList(),(this.tokenService.getRole()?.some(t=>t=="ADMIN")?1:0)==1?this.getClientsForAdmin():this.getClientsForEmploye()}getClientsForAdmin(){this.entrepriseSelectedService.getEntrepriseSelected()!=0?this.clientService.getClients(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>{this.clientList=e,console.log("Clients :",e)},error:e=>console.log(e)}):this.entrepriseService.findByAdmin(this.userInfosService.getUsername()).subscribe(e=>{this.entreprises=e,console.log("Entreprises: ",this.entreprises),this.entreprises&&this.entreprises.length>0?this.clientService.getClients(this.entreprises[0].id).subscribe({next:t=>{this.clientList=t,console.log("Clients :",t)},error:t=>console.log(t)}):console.log("Aucune entreprise trouv\xE9e.")},e=>{console.log(e)})}getClientsForEmploye(){this.entrepriseSelectedService.getEntrepriseSelected()!=0?this.clientService.getClients(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>{this.clientList=e,console.log("Clients :",e)},error:e=>console.log(e)}):this.employeService.findByUserName(this.userInfosService.getUsername()).subscribe(e=>{console.log("empId: ",e.id),this.entrepriseService.findEntreprisesAdroitAcces(e.id).subscribe(t=>{this.entreprises=t,console.log("Entreprises\xC0droit: ",this.entreprises),this.entreprises&&this.entreprises.length>0&&this.clientService.getClients(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:s=>{this.clientList=s,console.log("Clients :",s)},error:s=>console.log(s)})},t=>{console.log(t)})},e=>{console.log(e)})}loadEntrepriseList(){this.entrepriseService.findById(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>{this.item.entreprise=e,console.log("entre :",this.item.entreprise)},error:e=>console.log(e)})}update(){console.log(this.item),this.validator.validate()&&(this.sending=!0,this.service.update().subscribe({next:e=>{this.sending=!1,e!=null&&this.router.navigate(["/ventes/retourproduit/retour-produit"]).then()},error:e=>{this.sending=!1,console.log(e)}}))}reset(){this.resetting=!0,this.service.findById(this.item.id).subscribe({next:e=>{this.item=e,this.validator.reset(),this.resetting=!1},error:e=>{console.log(e),this.resetting=!1}})}get items(){return this.service.items}set items(e){this.service.items=e}get item(){return this.itemGetter()}set item(e){this.itemSetter(e)}itemGetter(){return this.service.item}itemSetter(e){this.service.item=e}get noteCredit(){return this.item.noteCredit==null&&(this.item.noteCredit=new he),this.item.noteCredit}set noteCredit(e){this.item.noteCredit=e}get remboursements(){return this.item.remboursements==null&&(this.item.remboursements=new fe),this.item.remboursements}set remboursements(e){this.item.remboursements=e}get client(){return this.item.client==null&&(this.item.client=new ae),this.item.client}set client(e){this.item.client=e}get entreprise(){return this.item.entreprise==null&&(this.item.entreprise=new ne),this.item.entreprise}set entreprise(e){this.item.entreprise=e}navigateToClientCreate(){this.clientService.returnUrl=this.router.url,this.router.navigate(["/contacts/client/create"]).then()}navigateToEntrepriseCreate(){this.entrepriseService.returnUrl=this.router.url,this.router.navigate(["/parametres/entreprise/create"]).then()}cancel(){this.item=new pe}retour(){this.router.navigate(["/pays/pays/list"]).then()}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=T({type:n,selectors:[["app-retour-produit-update"]],inputs:{setItemGetter:[0,"getter","setItemGetter"],setItemSetter:[0,"setter","setItemSetter"],setValidator:[0,"validator","setValidator"]},standalone:!0,features:[M],decls:8,vars:2,consts:[["createFrom",""],[1,"mb-3"],[1,"hstack","gap"],[1,"p-2","ms-auto"],["cButton","","color","secondary","variant","outline","routerLink","/ventes/retourproduit/retour-produit",3,"click"],[1,"p-2"],["cButton","","color","dark",3,"click"],["aria-hidden","true","size","sm"],["cIcon","","name","cilReload"],["cButton","","color","primary",3,"click"],["cIcon","","name","cilPen"],[4,"ngTemplateOutlet"],[1,"g-3"],["sm","4"],["cLabel","","for","client"],["cSelect","","id","client","name","client",3,"ngModelChange","blur","ngModel","valid"],[3,"value"],["cButton","","color","secondary","type","button","variant","outline",3,"click"],["cIcon","","name","cilPlus"],[3,"valid"]],template:function(t,s){t&1&&(p(0,ye,16,3),C(1,0,_e),p(3,we,1,1),C(4,3,ve),p(6,Pe,14,4,"ng-template",null,0,B)),t&2&&(o(),S(s.standAlon),o(3),S(!s.standAlon))},dependencies:[z,P,J,re,te,ie,ee,Z,$,q,O,W,H,I,j,w]});let i=n;return i})();export{nt as a};
