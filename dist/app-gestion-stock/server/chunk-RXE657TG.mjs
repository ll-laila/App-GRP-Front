import './polyfills.server.mjs';
import{a as Ge,b as We}from"./chunk-4MORXQWK.mjs";import"./chunk-IBKV64AH.mjs";import"./chunk-WQJ5A5RX.mjs";import{a as ze,b as Be}from"./chunk-YI7DQ4LI.mjs";import"./chunk-M2QOI6KZ.mjs";import"./chunk-TLCN7JBJ.mjs";import"./chunk-CTXIMDC5.mjs";import"./chunk-M25OBH6Z.mjs";import"./chunk-3GJOX54U.mjs";import{a as j}from"./chunk-HXC2Y4JH.mjs";import"./chunk-QXCLAHMT.mjs";import"./chunk-BHILNKWI.mjs";import{a as H,b as Ae}from"./chunk-GQ7BGXIS.mjs";import"./chunk-DGTYMJ3W.mjs";import"./chunk-OR4ZYGNA.mjs";import"./chunk-EAIC5JXJ.mjs";import{a as O,b as Me}from"./chunk-2IZGWHSK.mjs";import{b as Le}from"./chunk-PZO4XLW5.mjs";import"./chunk-NXGTTB3I.mjs";import{a as ke,b as Ie}from"./chunk-4O54P57Y.mjs";import"./chunk-Y2EI6LBU.mjs";import{a as Pe,b as De}from"./chunk-QVGIFFSU.mjs";import{a as Re,b as Fe}from"./chunk-AHRJE2FH.mjs";import{a as U,b as Ne}from"./chunk-XXWZ3SQU.mjs";import"./chunk-VMQIQJK7.mjs";import{a as F}from"./chunk-TQMIRSZL.mjs";import"./chunk-M5PYXWAU.mjs";import"./chunk-D4RJRHB5.mjs";import{a as de}from"./chunk-GYJGDPFA.mjs";import{a as Se,b as ye}from"./chunk-KUWVGZID.mjs";import{b as ue,c as _e,f as xe,h as ve,i as fe,j as he,k as Ce,m as ge,n as be}from"./chunk-MG5ECMPI.mjs";import{B as te,C as ie,D as ne,E as re,I as ae,M as oe,N as q,T as le,U as se,i as W,ma as me,na as ce,o as Z,p as $,r as ee}from"./chunk-BJSQRMLK.mjs";import"./chunk-XR27ODAI.mjs";import{c as B}from"./chunk-TMD5LWM3.mjs";import{a as Ve}from"./chunk-MHGFRO2M.mjs";import{a as pe}from"./chunk-JCP3ZGLC.mjs";import{b as Te}from"./chunk-TJ3A5ET5.mjs";import{a as Ee}from"./chunk-NLO6QWTG.mjs";import{a as we}from"./chunk-WHNHYHSL.mjs";import"./chunk-IIYCLNRC.mjs";import"./chunk-FO7JI6NW.mjs";import"./chunk-ENKAC57S.mjs";import{e as X,f as Y}from"./chunk-AO72HDTW.mjs";import"./chunk-TX6S5BIU.mjs";import"./chunk-OCP4HJ6B.mjs";import{Ab as A,Eb as m,Kb as G,Mb as k,Nb as I,Ob as L,Pb as n,Qb as r,Rb as v,Ub as P,Vb as R,Yb as x,_b as c,ga as f,gc as D,hb as a,hc as s,ic as _,jc as J,ka as Q,nc as S,oc as y,pc as E,rc as K,va as d,wa as p,xa as C,xc as z,ya as b,yb as M,zb as N}from"./chunk-NYO24GET.mjs";import"./chunk-XAJIYFV3.mjs";var Oe=()=>[q,import("./chunk-FBVZH4FD.mjs").then(l=>l.NgTemplateOutlet),W,Y,se,le,me,B],Ue=()=>[import("./chunk-FBVZH4FD.mjs").then(l=>l.NgTemplateOutlet)];function He(l,u){if(l&1){let i=R();n(0,"c-nav-item",4)(1,"button",12),x("click",function(){d(i);let t=c(2);return p(t.retour())}),s(2,"Return"),r()()}if(l&2){let i=c(2);a(),m("routerLink",i.returnUrl)}}function je(l,u){l&1&&v(0,"c-spinner",9)}function Qe(l,u){l&1&&(C(),v(0,"svg",10))}function Je(l,u){l&1&&P(0)}function Ke(l,u){l&1&&P(0)}function Xe(l,u){if(l&1){let i=R();n(0,"c-row",2)(1,"c-nav",3),M(2,He,3,1,"c-nav-item",4),n(3,"c-nav-item",5)(4,"button",6),x("click",function(){d(i);let t=c();return p(t.cancel())}),s(5,"Annuler"),r()(),n(6,"c-nav-item",4)(7,"button",7),x("click",function(){d(i);let t=c();return p(t.reset())}),s(8,"Reset"),r()(),n(9,"c-nav-item",4)(10,"button",8),x("click",function(){d(i);let t=c();return p(t.create())}),M(11,je,1,0,"c-spinner",9)(12,Qe,1,0,":svg:svg",10),s(13," Cr\xE9er "),r()()()(),M(14,Je,1,0,"ng-container",11)(15,Ke,1,0,"ng-container",11)}if(l&2){let i=c(),e=D(7),t=D(9);a(2),G(i.toReturn?2:-1),a(9),G(i.sending?11:12),a(3),m("ngTemplateOutlet",e),a(),m("ngTemplateOutlet",t)}}function Ye(l,u){l&1&&P(0)}function Ze(l,u){if(l&1&&M(0,Ye,1,0,"ng-container",11),l&2){c();let i=D(7);m("ngTemplateOutlet",i)}}function $e(l,u){if(l&1&&(n(0,"option",29),s(1),r()),l&2){let i=u.$implicit;m("value",i),a(),_(i)}}function et(l,u){if(l&1&&(n(0,"option",29),s(1),r()),l&2){let i=u.$implicit;m("value",i.id),a(),_(i.nom)}}function tt(l,u){if(l&1&&(n(0,"option",29),s(1),r()),l&2){let i=u.$implicit;m("value",i.id),a(),_(i.nom)}}function it(l,u){if(l&1&&(n(0,"option",29),s(1),r()),l&2){let i=u.$implicit;m("value",i.id),a(),_(i.nom)}}function nt(l,u){if(l&1&&(n(0,"option",29),s(1),r()),l&2){let i=u.$implicit;m("value",i.id),a(),_(i.nouvelleDevise==null?null:i.nouvelleDevise.labelle)}}function rt(l,u){if(l&1){let i=R();n(0,"c-card",2)(1,"c-card-header")(2,"strong",13),s(3,'Veuillez remplir les informations ci-dessous pour cr\xE9er une nouvelle "Commande"'),r()(),n(4,"c-card-body")(5,"c-row",14)(6,"c-col",15),C(),v(7,"svg",16),b(),n(8,"label",17),s(9,"Code"),r(),n(10,"input",18),E("ngModelChange",function(t){d(i);let o=c();return y(o.item.code,t)||(o.item.code=t),p(t)}),x("blur",function(){d(i);let t=c();return p(t.validator.code.validate())}),r(),n(11,"c-form-feedback",19),s(12),r()(),n(13,"c-col",15),C(),v(14,"svg",20),b(),n(15,"label",21),s(16,"Date d'\xE9xpiration"),r(),n(17,"input",22),E("ngModelChange",function(t){d(i);let o=c();return y(o.item.dateExperation,t)||(o.item.dateExperation=t),p(t)}),x("blur",function(){d(i);let t=c();return p(t.validator.dateExperation.validate())}),r(),n(18,"c-form-feedback",19),s(19),r()(),n(20,"c-col",15),C(),v(21,"svg",23),b(),n(22,"label",24),s(23,"Remise"),r(),n(24,"input",25),E("ngModelChange",function(t){d(i);let o=c();return y(o.item.rabais,t)||(o.item.rabais=t),p(t)}),x("blur",function(){d(i);let t=c();return p(t.validator.rabais.validate())}),r(),n(25,"c-form-feedback",19),s(26),r()(),n(27,"c-col",15),C(),v(28,"svg",26),b(),n(29,"label",27),s(30,"Type de Remise"),r(),n(31,"select",28),E("ngModelChange",function(t){d(i);let o=c();return y(o.item.typeRabais,t)||(o.item.typeRabais=t),p(t)}),x("blur",function(){d(i);let t=c();return p(t.validator.typeRabais.validate())}),I(32,$e,2,2,"option",29,k),r(),n(34,"c-form-feedback",19),s(35),r()(),n(36,"c-col",15),C(),v(37,"svg",30),b(),n(38,"label",31),s(39,"Taxe"),r(),n(40,"c-input-group")(41,"select",32),E("ngModelChange",function(t){d(i);let o=c();return y(o.taxe.id,t)||(o.taxe.id=t),p(t)}),x("blur",function(){d(i);let t=c();return p(t.validator.taxe.validate())}),I(42,et,2,2,"option",29,k),r(),n(44,"button",33),x("click",function(){d(i);let t=c();return p(t.navigateToTaxeCreate())}),C(),v(45,"svg",10),r(),b(),n(46,"c-form-feedback",19),s(47),r()()(),n(48,"c-col",15),C(),v(49,"svg",30),b(),n(50,"label",34),s(51,"Taxe d'\xE9xpedition"),r(),n(52,"c-input-group")(53,"select",35),E("ngModelChange",function(t){d(i);let o=c();return y(o.taxeExpedition.id,t)||(o.taxeExpedition.id=t),p(t)}),x("blur",function(){d(i);let t=c();return p(t.validator.taxeExpedition.validate())}),I(54,tt,2,2,"option",29,k),r(),n(56,"button",33),x("click",function(){d(i);let t=c();return p(t.navigateToTaxeCreate())}),C(),v(57,"svg",10),r(),b(),n(58,"c-form-feedback",19),s(59),r()()(),n(60,"c-col",15),C(),v(61,"svg",36),b(),n(62,"label",37),s(63,"Client"),r(),n(64,"c-input-group")(65,"select",38),E("ngModelChange",function(t){d(i);let o=c();return y(o.client.id,t)||(o.client.id=t),p(t)}),x("blur",function(){d(i);let t=c();return p(t.validator.client.validate())}),I(66,it,2,2,"option",29,k),r(),n(68,"button",33),x("click",function(){d(i);let t=c();return p(t.navigateToClientCreate())}),C(),v(69,"svg",10),r(),b(),n(70,"c-form-feedback",19),s(71),r()()(),n(72,"c-col",15),C(),v(73,"svg",39),b(),n(74,"label",40),s(75,"Devise"),r(),n(76,"c-input-group")(77,"select",41),E("ngModelChange",function(t){d(i);let o=c();return y(o.devises.id,t)||(o.devises.id=t),p(t)}),x("blur",function(){d(i);let t=c();return p(t.validator.devises.validate())}),I(78,nt,2,2,"option",29,k),r(),n(80,"button",33),x("click",function(){d(i);let t=c();return p(t.navigateToDevisesCreate())}),C(),v(81,"svg",10),r(),b(),n(82,"c-form-feedback",19),s(83),r()()(),n(84,"c-col",15),C(),v(85,"svg",42),b(),n(86,"label",43),s(87,"Entreprise"),r(),n(88,"input",44),x("blur",function(){d(i);let t=c();return p(t.validator.code.validate())}),r(),n(89,"c-form-feedback",19),s(90),r()()()()()}if(l&2){let i=c();a(10),S("ngModel",i.item.code),m("valid",i.validator.code.valid),a(),m("valid",!1),a(),_(i.validator.code.message),a(5),S("ngModel",i.item.dateExperation),m("valid",i.validator.dateExperation.valid),a(),m("valid",!1),a(),_(i.validator.dateExperation.message),a(5),S("ngModel",i.item.rabais),m("valid",i.validator.rabais.valid),a(),m("valid",!1),a(),_(i.validator.rabais.message),a(5),S("ngModel",i.item.typeRabais),m("valid",i.validator.typeRabais.valid),a(),L(i.typeRabaisEnumList),a(2),m("valid",!1),a(),_(i.validator.typeRabais.message),a(6),S("ngModel",i.taxe.id),m("valid",i.validator.taxe.valid),a(),L(i.taxeList),a(4),m("valid",!1),a(),_(i.validator.taxe.message),a(6),S("ngModel",i.taxeExpedition.id),m("valid",i.validator.taxeExpedition.valid),a(),L(i.taxeList),a(4),m("valid",!1),a(),_(i.validator.taxeExpedition.message),a(6),S("ngModel",i.client.id),m("valid",i.validator.client.valid),a(),L(i.clientList),a(4),m("valid",!1),a(),_(i.validator.client.message),a(6),S("ngModel",i.devises.id),m("valid",i.validator.devises.valid),a(),L(i.devisesList),a(4),m("valid",!1),a(),_(i.validator.devises.message),a(5),m("value",i.item.entreprise==null?null:i.item.entreprise.nom)("valid",i.validator.code.valid),a(),m("valid",!1),a(),_(i.validator.code.message)}}function at(l,u){if(l&1){let i=R();n(0,"tr")(1,"td"),s(2),r(),n(3,"td"),s(4),r(),n(5,"td"),s(6),r(),n(7,"td")(8,"input",60),E("ngModelChange",function(t){let o=d(i).$implicit;return y(o.quantite,t)||(o.quantite=t),p(t)}),x("ngModelChange",function(){let t=d(i).$implicit,o=c(2);return p(o.onInputChange(t))}),r()(),n(9,"td"),s(10),r(),n(11,"td"),s(12),r(),n(13,"td")(14,"input",60),E("ngModelChange",function(t){let o=d(i).$implicit;return y(o.disque,t)||(o.disque=t),p(t)}),x("ngModelChange",function(){let t=d(i).$implicit,o=c(2);return p(o.onInputChange(t))}),r()(),n(15,"td",61)(16,"button",62),x("click",function(){let t=d(i).$implicit,o=c(2);return p(o.deleteCommandeProduit(t))}),C(),v(17,"svg",63),r()()()}if(l&2){let i=u.$implicit;a(2),J(" ",i.produit!=null?i.produit.nom:"null"," "),a(2),_(i.prix),a(2),_(i.total),a(2),S("ngModel",i.quantite),a(2),_(i.produit==null||i.produit.taxe==null?null:i.produit.taxe.nom),a(2),_(i.produit==null?null:i.produit.disponible),a(2),S("ngModel",i.disque)}}function ot(l,u){if(l&1&&(n(0,"option",51),s(1),r()),l&2){let i=u.$implicit;m("ngValue",i),a(),_(i.nom)}}function lt(l,u){if(l&1){let i=R();n(0,"c-card",2)(1,"c-card-header")(2,"strong"),s(3,"S\xE9lectionner des produits"),r()(),n(4,"c-card-body")(5,"table",45)(6,"thead",46)(7,"tr")(8,"th",47),s(9,"Produit"),r(),n(10,"th",47),s(11,"Prix"),r(),n(12,"th",47),s(13,"Total"),r(),n(14,"th",47),s(15,"Quantite"),r(),n(16,"th",47),s(17,"Taxe"),r(),n(18,"th",47),s(19,"Disponible"),r(),n(20,"th",47),s(21,"Disque"),r(),n(22,"th",48),s(23,"Actions"),r()()(),n(24,"tbody"),I(25,at,18,7,"tr",null,k),r()(),n(27,"c-col",49)(28,"c-input-group")(29,"select",50),x("ngModelChange",function(t){d(i);let o=c();return p(o.addCommandeProduits(t))}),I(30,ot,2,2,"option",51,k),r()()()()(),n(32,"c-card")(33,"c-card-body")(34,"c-col",15)(35,"label",52),s(36,"Unit\xE9s total "),r(),v(37,"input",53),n(38,"c-form-feedback",19),s(39),r()(),n(40,"c-col",15)(41,"label",54),s(42,"Remise Global"),r(),v(43,"input",55),r(),n(44,"c-col",15)(45,"label",56),s(46,"Sous total"),r(),v(47,"input",57),n(48,"c-form-feedback",19),s(49),r()(),n(50,"c-col",15)(51,"label",58),s(52,"Total"),r(),v(53,"input",59),n(54,"c-form-feedback",19),s(55),r()()()()}if(l&2){let i=c();a(5),m("hover",!0)("responsive",!0)("striped",!0),a(20),L(i.commandeProduit),a(5),L(i.produitList),a(7),m("value",i.calculeSommeQuantite(i.commandeProduit)),a(),m("valid",!1),a(),_(i.validator.totalUnites.message),a(4),m("value",i.calculeRemiseGlobal(i.commandeProduit)),a(4),m("value",i.calculeSommeSousTotal(i.commandeProduit)),a(),m("valid",!1),a(),_(i.validator.sousTotal.message),a(4),m("value",i.calculeSommeTotale(i.commandeProduit)),a(),m("valid",!1),a(),_(i.validator.total.message)}}var Zt=(()=>{let u=class u{constructor(){this.sending=!1,this.standAlon=!0,this.router=f(X),this.service=f(Me),this.taxeService=f(Ne),this.clientService=f(Ie),this.employeService=f(Te),this.devisesService=f(Fe),this.niveauPrixService=f(De),this.entrepriseService=f(ye),this.commandeProduitService=f(Be),this.produitService=f(Le),this.factureService=f(Ae),this.formBuilder=f(ge),this.toasterService=f(de),this.notificationService=f(Ve),this.entrepriseSelectedService=f(Ee),this.userInfosService=f(we),this.tokenService=f(pe),this.validator=Ge.init(()=>this.item),this.TypeRabaisEnum=j,this.currentCodeNumber=1,this.dispo=0,this.factureGetter=()=>this.facture,this.factureSetter=e=>this.facture=e,this.addressFacturationGetter=()=>this.addressFacturation,this.addressFacturationSetter=e=>this.addressFacturation=e,this.addressExpeditionGetter=()=>this.addressExpedition,this.addressExpeditionSetter=e=>this.addressExpedition=e,this.typeRabaisEnumList=Object.values(j),this.statutCommandeEnumList=Object.values(We)}set setItemGetter(e){this.itemGetter=e,this.standAlon=!1}set setItemSetter(e){this.itemSetter=e}set setValidator(e){this.validator=e}ngOnInit(){if(this.loadEntreprise(),this.service.keepData){let t=this.taxeService.createdItemAfterReturn;t.created&&(this.item.taxe=t.item);let o=this.taxeService.createdItemAfterReturn;o.created&&(this.item.taxeExpedition=o.item);let h=this.clientService.createdItemAfterReturn;h.created&&(this.item.client=h.item,this.validator.client.validate());let w=this.devisesService.createdItemAfterReturn;w.created&&(this.item.devises=w.item);let V=this.niveauPrixService.createdItemAfterReturn;V.created&&(this.item.niveauPrix=V.item)}else this.reset(!1);this.service.keepData=!1,this.item.facture=new H,this.item.addressFacturation=new F,this.item.addressExpedition=new F,this.loadTaxeList(),this.loadProduitList(),this.loadDevisesList(),this.loadNiveauPrixList(),this.loadEntrepriseList(),(this.tokenService.getRole()?.some(t=>t=="ADMIN")?1:0)==1?this.getClientsForAdmin():this.getClientsForEmploye(),this.clientForm=this.formBuilder.group({code:[{value:this.generateCode(),disabled:!0}]}),this.service.getNextCode().subscribe({next:t=>this.item.code=t.code,error:t=>console.log(t)})}generateCode(){return"I"+this.currentCodeNumber.toString().padStart(7,"0")}loadProduitList(){this.produitService.findByEntrepriseId(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>this.produitList=e,error:e=>console.log(e)})}loadEntreprise(){this.entrepriseService.findById(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>{this.item.entreprise=e,console.log("entre :",this.item.entreprise)},error:e=>console.log(e)})}loadTaxeList(){this.taxeService.findAllOptimized().subscribe({next:e=>this.taxeList=e,error:e=>console.log(e)})}getClientsForAdmin(){this.entrepriseSelectedService.getEntrepriseSelected()!=0?this.clientService.getClients(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>{this.clientList=e,console.log("Clients :",e)},error:e=>console.log(e)}):this.entrepriseService.findByAdmin(this.userInfosService.getUsername()).subscribe(e=>{this.entreprises=e,console.log("Entreprises: ",this.entreprises),this.entreprises&&this.entreprises.length>0?this.clientService.getClients(this.entreprises[0].id).subscribe({next:t=>{this.clientList=t,console.log("Clients :",t)},error:t=>console.log(t)}):console.log("Aucune entreprise trouv\xE9e.")},e=>{console.log(e)})}getClientsForEmploye(){this.entrepriseSelectedService.getEntrepriseSelected()!=0?this.clientService.getClients(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:e=>{this.clientList=e,console.log("Clients :",e)},error:e=>console.log(e)}):this.employeService.findByUserName(this.userInfosService.getUsername()).subscribe(e=>{console.log("empId: ",e.id),this.entrepriseService.findEntreprisesAdroitAcces(e.id).subscribe(t=>{this.entreprises=t,console.log("Entreprises\xC0droit: ",this.entreprises),this.entreprises&&this.entreprises.length>0&&this.clientService.getClients(this.entrepriseSelectedService.getEntrepriseSelected()).subscribe({next:o=>{this.clientList=o,console.log("Clients :",o)},error:o=>console.log(o)})},t=>{console.log(t)})},e=>{console.log(e)})}loadDevisesList(){this.devisesService.findAllOptimized().subscribe({next:e=>this.devisesList=e,error:e=>console.log(e)})}loadNiveauPrixList(){this.niveauPrixService.findAllOptimized().subscribe({next:e=>this.niveauPrixList=e,error:e=>console.log(e)})}loadEntrepriseList(){this.entrepriseService.findAllOptimized().subscribe({next:e=>this.entrepriseList=e,error:e=>console.log(e)})}create(){if(this.notificationService.handelcreate("Creation d'une commande","Une nouvelle commande \xE0 \xE9t\xE9 cr\xE9e par l'employer",this.entrepriseSelectedService.getEntrepriseSelected()),console.log(this.item),!this.validator.validate()){console.log(this.validator);return}this.sending=!0,this.service.create().subscribe({next:e=>{if(this.sending=!1,e!=null){if(this.item=e,this.toReturn){this.router.navigate([this.returnUrl]).then();return}this.router.navigate(["/ventes/commande/commande/commandePdf"]).then(),this.toasterService.toast({message:"Une nouvelle commande a \xE9t\xE9 ajout\xE9",color:"success"})}},error:e=>{this.sending=!1,console.log(e),this.validator.import(e.error)}})}addCommandeProduits(e){console.log(e),this.item.commandeProduit==null&&(this.item.commandeProduit=[]);let t=new ze;t.produit=e,t.produit=e,t.disque=0,t.quantite=1,this.dispo=e.disponible,e.disponible=e?.disponible-t?.quantite,t.disponible=e.disponible,t.prix=e?.produitNiveauPrix?.filter(o=>o.niveauPrix?.id==this.client?.niveauPrix?.id)[0]?.prix||e.prixGros,console.log("prix",t.prix),t.total=this.calculerTotal(t),this.item.commandeProduit=[...this.item.commandeProduit,t],console.log(this.item.commandeProduit)}onInputChange(e){e.quantite>0&&e.disque>0&&(e.produit&&(e.produit.disponible=this.dispo-e.quantite),e.total=this.calculerTotal(e))}calculerTotal(e){console.log(this.item);let t=0;if(e.produit){let o=0,h=this.client.id;this.findClient(h),o=e.produit?.produitNiveauPrix?.filter(g=>g.niveauPrix?.nom==this?.clientP?.niveauPrix?.nom)[0]?.prix||e.produit.prixGros,console.log("prixProduit",o);let w=e.quantite*o,V=e.produit.taxe?e.produit.taxe?.tauxImposition:0;if(this.item.typeRabais!=null&&this.item.typeRabais==this.TypeRabaisEnum.POURCENTAGE){let g=w*(1+V/100),T=g*(e.disque/100);t=g-T}if(this.item?.typeRabais!=null&&this.item?.typeRabais==this.TypeRabaisEnum.MONTANT){let g=w*(1+V/100),T=e.disque;t=g-T}}return parseFloat(t.toFixed(2))}calculeSommeQuantite(e){let t=e.reduce((o,h)=>o+(h.quantite||0),0);return this.item.totalUnites=t,t}calculeRemiseGlobal(e){let t=e.reduce((o,h)=>o+(h.disque||0),0);return this.item.remiseGlobal=t+this.item.rabais,this.item.remiseGlobal}calculeSommeSousTotal(e){let t=e.reduce((o,h)=>h?.quantite&&h?.prix?o+h.quantite*h.prix:o,0);return this.item.sousTotal=t,t.toFixed(2)}calculeSommeTotale(e){let t=e.reduce((g,T)=>{let qe=this.calculerTotal(T);return g+qe},0),o=this.taxeList?.filter(g=>g.id==this.item.taxe?.id)[0]?.tauxImposition,h=this.item.taxeExpedition?.tauxImposition!=null?this.item.taxeExpedition.tauxImposition:0,w=0;if(this.item.typeRabais!=null&&this.item.typeRabais==this.TypeRabaisEnum.POURCENTAGE){let g=t*(1+(o+h)/100),T=g*(this.item.rabais/100);w=g-T}if(this.item?.typeRabais!=null&&this.item?.typeRabais==this.TypeRabaisEnum.MONTANT){let g=t*(1+(o+h)/100),T=this.item.rabais;w=g-T}let V=parseFloat(w.toFixed(2));return this.item.total=V,V}deleteCommandeProduit(e){e.produit&&(e.produit.disponible=e.produit.disponible+e.quantite),this.item.commandeProduit=this.item.commandeProduit?.filter(t=>t!==e)}findClient(e){this.clientService.findById(e).subscribe(t=>{console.log(t),this.clientP=t},t=>{console.log(t)})}reset(e=!0){(e||this.item==null)&&(this.item=new O),this.validator.reset()}get items(){return this.service.items}set items(e){this.service.items=e}get item(){return this.itemGetter()}get commandeProduit(){return this.item.commandeProduit==null&&(this.item.commandeProduit=[]),this.item.commandeProduit}set item(e){this.itemSetter(e)}itemGetter(){return this.service.item}itemSetter(e){this.service.item=e}get facture(){return this.item.facture==null&&(this.item.facture=new H),this.item.facture}set facture(e){this.item.facture=e}get itemCP(){return this.commandeProduitService.item}get addressFacturation(){return this.item.addressFacturation==null&&(this.item.addressFacturation=new F),this.item.addressFacturation}set addressFacturation(e){this.item.addressFacturation=e}get addressExpedition(){return this.item.addressExpedition==null&&(this.item.addressExpedition=new F),this.item.addressExpedition}set addressExpedition(e){this.item.addressExpedition=e}get taxe(){return this.item.taxe==null&&(this.item.taxe=new U),this.item.taxe}set taxe(e){this.item.taxe=e}get taxeExpedition(){return this.item.taxeExpedition==null&&(this.item.taxeExpedition=new U),this.item.taxeExpedition}set taxeExpedition(e){this.item.taxeExpedition=e}get client(){return this.item.client==null&&(this.item.client=new ke),this.item.client}set client(e){this.item.client=e}get devises(){return this.item.devises==null&&(this.item.devises=new Re),this.item.devises}set devises(e){this.item.devises=e}get niveauPrix(){return this.item.niveauPrix==null&&(this.item.niveauPrix=new Pe),this.item.niveauPrix}set niveauPrix(e){this.item.niveauPrix=e}get entreprise(){return this.item.entreprise==null&&(this.item.entreprise=new Se),this.item.entreprise}set entreprise(e){this.item.entreprise=e}get returnUrl(){return this.service.returnUrl}get toReturn(){return this.service.toReturn()}navigateToTaxeCreate(){this.taxeService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/parametres/taxe/create"]).then()}navigateToClientCreate(){this.clientService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/contacts/client/create"]).then()}navigateToDevisesCreate(){this.devisesService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/parametres/devises/create"]).then()}navigateToNiveauPrixCreate(){this.niveauPrixService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/parametres/niveau-prix/create"]).then()}navigateToEntrepriseCreate(){this.entrepriseService.returnUrl=this.router.url,this.service.keepData=!0,this.router.navigate(["/parametres/entreprise/create"]).then()}cancel(){this.item=new O}retour(){this.router.navigate(["/pays/pays/list"]).then()}};u.\u0275fac=function(t){return new(t||u)},u.\u0275cmp=Q({type:u,selectors:[["app-commande-create"]],inputs:{setItemGetter:[0,"getter","setItemGetter"],setItemSetter:[0,"setter","setItemSetter"],setValidator:[0,"validator","setValidator"]},standalone:!0,features:[K],decls:10,vars:2,consts:[["createFrom",""],["commandeProduitCreate",""],[1,"mb-3"],[1,"hstack","gap"],[1,"p-2"],[1,"p-2","ms-auto"],["cButton","","color","secondary","variant","outline","routerLink","/ventes/commande/commande",3,"click"],["cButton","","color","dark",3,"click"],["cButton","","color","primary",3,"click"],["aria-hidden","true","size","sm"],["cIcon","","name","cilPlus"],[4,"ngTemplateOutlet"],["cButton","","color","secondary",3,"click","routerLink"],[1,"responsive-header",2,"color","#1d0528","font-family","'Times New Roman'","font-size","21px","margin-left","300px"],[1,"g-3"],["sm","4"],["cIcon","","name","cil-barcode",2,"color","blue","font-size","30px"],["cLabel","","for","code",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","code","type","text","placeholder","Code","name","code","disabled","true",2,"background-color","#ffffff",3,"ngModelChange","blur","ngModel","valid"],[3,"valid"],["cIcon","","name","cil-calendar",2,"color","blue","font-size","30px"],["cLabel","","for","dateExperation",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","dateExperation","type","date","placeholder","DateExperation","name","dateExperation",3,"ngModelChange","blur","ngModel","valid"],["cIcon","","name","cil-sort-descending",2,"color","blue","font-size","30px"],["cLabel","","for","rabais",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","rabais","type","number","name","rabais",3,"ngModelChange","blur","ngModel","valid"],["cIcon","","name","cil-tags",2,"color","blue","font-size","30px"],["cLabel","","for","typeRabais",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cSelect","","id","typeRabais","name","typeRabais",3,"ngModelChange","blur","ngModel","valid"],[3,"value"],["cIcon","","name","cil-sort-ascending",2,"color","blue","font-size","30px"],["cLabel","","for","taxe",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cSelect","","id","taxe","name","taxe",3,"ngModelChange","blur","ngModel","valid"],["cButton","","color","secondary","type","button","variant","outline",3,"click"],["cLabel","","for","taxeExpedition",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cSelect","","id","taxeExpedition","name","taxeExpedition",3,"ngModelChange","blur","ngModel","valid"],["cIcon","","name","cilUser",2,"color","blue","font-size","30px"],["cLabel","","for","client",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cSelect","","id","client","name","client",3,"ngModelChange","blur","ngModel","valid"],["cIcon","","name","cil-dollar",2,"color","blue","font-size","30px"],["cLabel","","for","devises",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cSelect","","id","devises","name","devises",3,"ngModelChange","blur","ngModel","valid"],["cIcon","","name","cil-building",2,"color","blue","font-size","30px"],["cLabel","","for","entreprise",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","entreprise","type","text","name","entreprise","disabled","true",3,"blur","value","valid"],["align","middle","cTable","",1,"mb-0","border",3,"hover","responsive","striped"],[1,"text-nowrap","text-truncate"],[1,"bg-body-tertiary"],[1,"bg-body-tertiary",2,"display","flex","justify-content","end"],["sm","3",1,"mt-3"],["cSelect","","ngModel","",3,"ngModelChange"],[3,"ngValue"],["cLabel","","for","qte",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","qte","type","number","readonly","","name","qte",3,"value"],["cLabel","","for","sommeRemise",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","sommeRemise","type","number","readonly","","name","sommeRemise",3,"value"],["cLabel","","for","stotal",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","stotal","type","number","readonly","","name","stotal",3,"value"],["cLabel","","for","total",2,"color","black","font-family","'Times New Roman'","font-size","18px","font-weight","bold"],["cFormControl","","id","total","type","number","readonly","","name","total",3,"value"],["type","number",3,"ngModelChange","ngModel"],[2,"display","flex","justify-content","end"],["cButton","","color","",3,"click"],["cIcon","","name","cil-trash","size","lg"]],template:function(t,o){t&1&&(M(0,Xe,16,4),N(1,0,Oe),M(3,Ze,1,1),N(4,3,Ue),M(6,rt,91,36,"ng-template",null,0,z)(8,lt,56,13,"ng-template",null,1,z)),t&2&&(a(),A(o.standAlon),a(3),A(!o.standAlon))},dependencies:[ne,q,oe,ae,be,he,Ce,ue,ve,fe,_e,xe,re,Z,$,ee,ie,W,B,te,ce],styles:['@charset "UTF-8";.responsive-header[_ngcontent-%COMP%]{font-family:Times New Roman;font-size:21px;margin-left:300px}@media (max-width: 1024px){.responsive-header[_ngcontent-%COMP%]{font-size:18px;margin-left:100px}}@media (max-width: 768px){.responsive-header[_ngcontent-%COMP%]{font-size:16px;margin-left:50px;text-align:center}}@media (max-width: 480px){.responsive-header[_ngcontent-%COMP%]{font-size:14px;margin-left:20px;text-align:center}}']});let l=u;return l})();export{Zt as CommandeCreateComponent};
